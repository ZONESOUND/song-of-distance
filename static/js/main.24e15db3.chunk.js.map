{"version":3,"sources":["socketUsage.js","config.js","sound.js","sketch.js","firebase.js","gps.js","NameModal.js","IntroModal.js","LocHintModal.js","ControlPanel.js","App.js","index.js","sound/C3_mid_long_44.1k.mp3","sound/C2_low_short_44.1k.mp3","img/Settings-icon.png"],"names":["socket","io","isSocketConnect","on","console","log","reverb","comp","samplerLong","samplerShort","finalFilter","emitOSC","address","value","emit","args","receiveOSC","func","octave","noteNumber","Tone","Frequency","toFrequency","noteSynth","notePlaying","initSound","limiter","Limiter","toMaster","Compressor","connect","ratio","Reverb","pre_delay","decay","wet","generate","Filter","rolloff","initNote","C3","Sampler","attack","C2","i","genSineSynth","ind","Synth","oscillator","type","envelope","sustain","release","decayCurve","triggerSound","d","layer","Math","ceil","dis","max","scaleNumber","note","freq","getNote","filter","Q","leave","triggerAttack","setTimeout","number","floor","pow","random","min","len","length","makesound","temp","volume","triggerAttackRelease","sketch","p","myId","testBtn","radioDeg","lastRadioDeg","allDataPoint","dataPoint","configData","enableUpdate","lightCounter","rDistArr","data","JSON","parse","id","setup","createCanvas","windowWidth","windowHeight","frameRate","createButton","position","mousePressed","windowResized","resizeCanvas","myCustomRedrawAccordingToNewPropsHandler","props","calcRdistArr","Object","keys","updateDataPoint","dataPointMap","e","pos","obj","lon","lat","globalScale","result","createVector","x","abs","globalPow","y","getPos","dist","mag","toFixed","deg","heading","PI","degree","num","int","frameCount","threshold","calcR","slice","map","draw","radioSpeed","background","textSize","fill","stroke","strokeWeight","text","calcPerson","calcActive","push","textLeading","Date","height","pop","drawText","translate","width","noFill","r","sin","noise","beginShape","LINES","o","useR","calcWaveR","vertex","cos","radians","endShape","noStroke","CLOSE","ellipse","drawCircle","lastTrigger","forEach","eid","angleDelta","timeDelta","now","timeStamp","dataDegree","nowId","showId","scanned","calcReverseR","d2","stringify","key","time_to_now_second","useAngle","scanAfter","rect","textWidth","rectMode","CENTER","rotate","drawDataPoint","line","drawSwipeLine","centerName","drawCenter","textAlign","drawMapFrame","sec","getSeconds","drawSecRect","mult","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","earthLocRef","ref","child","gpsData","watchCallBack","gpsHelp","userAgent","navigator","vendor","window","opera","test","MSStream","getSettingStr","showPosition","coords","latitude","longitude","date","watchPositionError","positionError","code","NameModal","useState","show","setShow","name","setName","handleClose","onChange","useEffect","Modal","centered","dialogClassName","backdropClassName","Body","bsPrefix","htmlFor","placeholder","target","className","Footer","Button","variant","size","onClick","IntroModal","onHide","Header","closeButton","class","LocHintModal","os","IOSHint","AndroidHint","src","setting","alt","grayStyle","color","fontWeight","style","SESSION_ID","SESSION_NAME","SESSION_TIME","LocData","state","gp","gpsPermission","gpsPermit","b","setState","initGPS","updateDataSet","allLocations","checkData","entries","set","getShowId","remove","callback","geolocation","watchPosition","setupGPS","this","snapshot","val","Component","ControlPanel","maxLineLength","naming","addGPSKey","lastId","localStorage","getItem","lastIdTime","setItem","changeCenterName","updateFirebase","saveControlData","sessionStorage","handleWindowBeforeUnload","addEventListener","removeEventListener","split","ch","charCodeAt","reduce","a","App","React","ReactDOM","render","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.24e15db3.chunk.js","sourcesContent":["import io from 'socket.io-client';\nimport {serverIP} from './config';\n\nconst socket = io(serverIP);\nlet isSocketConnect = false;\nsocket.on('connect', () => {\n    isSocketConnect = true;\n    console.log('socket connect to server');\n})\n\nexport let emitOSC = (address, value)=> {\n    socket.emit('osc', {\n        address: address,\n        args: [{\n            value: value\n        }]\n    });\n}\n\nexport let receiveOSC = (func) => {\n    socket.on('osc', func);\n}\n\nexport {isSocketConnect};","export const firebaseConfig = {\n    //put firebase config here\n    apiKey: \"AIzaSyBlfFaGBx7B_nBnlR29yhJAr6kPjqAdLfo\",\n    authDomain: \"test-84ae7.firebaseapp.com\",\n    databaseURL: \"https://test-84ae7.firebaseio.com\",\n    projectId: \"test-84ae7\",\n    storageBucket: \"test-84ae7.appspot.com\",\n    messagingSenderId: \"762464277938\"\n};\nexport const serverIP = 'https://gps-250305.appspot.com'; // change IP here\n//https://gps-250305.appspot.com","import Tone from 'tone';\nimport C3 from './sound/C3_mid_long_44.1k.mp3';\nimport C2 from './sound/C2_low_short_44.1k.mp3';\n\nlet mode = 3; \n//let octave = 'CDEFGAB'; //start from index 1 so put C at second \nlet octave = ['C', 'D', 'Eb', 'F', 'G', 'A', 'Bb'];\nlet octaveStart = 2;\nlet octaveMax = 5;\n\nlet startFreq = Tone.Frequency('F3').toFrequency();\nlet noteBetween = 5;\nlet noteNumber = 9;\n\nlet layerInner = 2;\nlet layerOuter = 15;\n\nlet noteDuration = 200;\nlet synth, reverb, comp, samplerLong, samplerShort, finalFilter;\nlet noteTimeout = {};\nlet noteSynth = {};\nlet notePlaying = {};\n\nexport let initSound = () => {\n    var limiter = new Tone.Limiter(-0.5).toMaster();\n    comp = new Tone.Compressor(-30, 3).connect(limiter); \n    comp.ratio.value = 20;   \n    reverb = new Tone.Reverb({\n        pre_delay: 0.05,\n        decay: 5,\n        wet: 0.6,\n    }).connect(comp);\n    reverb.generate();\n    finalFilter = new Tone.Filter(6000, 'lowpass');\n    finalFilter.rolloff = -12;\n    finalFilter.connect(reverb);\n    if (mode === 0) noteNumber = octave.length*(octaveMax-octaveStart+1);\n    initNote();\n    console.log('sample here', C3);\n    samplerLong = new Tone.Sampler({\n        \"C3\" : C3,\n        //\"C2\" : C2,\n    }, function() {\n      console.log('sample load!');\n      samplerLong.attack = 0.25;\n      //samplerLong.triggerAttack(\"D3\");\n    }).connect(finalFilter);\n    samplerShort = new Tone.Sampler({\n        \"C2\" : C2,\n    }, function() {\n      console.log('short sample load!');\n      //sampler.triggerAttack(\"D3\");\n    }).connect(finalFilter);\n    //return;\n    // synth = new Tone.Synth({\n    //     oscillator : {type:'sine'} ,\n    //     envelope : {\n    //         attack: 0.1 ,\n    //         decay: 0.1 ,\n    //         sustain: 0.2 ,\n    //         release: 0.5\n    //     }});\n        //.chain(filter, reverb);\n}\n\nlet initNote = () => {\n    for (let i=0; i<noteNumber; i++) {\n        genSineSynth(i);\n        notePlaying[i] = false;\n        //genFMSynth(i);\n    }\n    \n}\n\n\nlet genSineSynth = (ind) => {\n    noteSynth[ind] = new Tone.Synth({\n        oscillator : {type:'sine'} ,\n        envelope : {\n            attack: 0.1 ,\n            decay: 5 ,\n            sustain: 0.15 ,\n            release: 0.5\n        }});\n    noteSynth[ind].envelope.decayCurve = 'exponential';\n}\n\nlet genFMSynth = (ind) => {\n    noteSynth[ind] = new Tone.FMSynth({envelope:{\n        attack: 0.1 ,\n        decay: 5 ,\n        sustain: 0.2 ,\n        release: 0.5\n    }});\n    noteSynth[ind].envelope.decayCurve = 'exponential';\n}\n\nexport let triggerSound = (d) => {\n\n    let layer = Math.ceil(d.layer);\n    let dis = Math.max(0.5, layer - d.layer);\n    layer = scaleNumber(layer);\n    let note = 0;\n    let freq = 0;\n    switch (mode) {\n        case 0:\n            note = getNote(layer);\n            freq = Tone.Frequency(note).toFrequency()*0.8*dis;\n            break;\n        case 1:\n            note = getFreq(layer);\n            freq = note*0.8*dis;\n            break;\n        case 2:\n            note = getFreq(layer);\n            freq = note*0.8*dis;\n            break;\n        case 3:\n            note = getNote(layer);\n            freq = Tone.Frequency(note).toFrequency()*dis;\n            break;\n        default:\n            break;\n    }\n    //let note = getFreq(layer);\n    //let freq = note*0.8*dis;\n    let filter = new Tone.Filter(freq, 'lowpass');\n    filter.Q.value = 2;\n\n    if (d.leave !== true) {\n        //mode ? note : Tone.Frequency(note)\n        if (mode >= 2) {\n            console.log('~')\n            samplerLong.connect(filter).triggerAttack(note); \n        }\n        else triggerActive(note);\n        //triggerMetal(mode ? note : Tone.Frequency(note), dis*200+600, 12);\n        return;\n    }\n    \n    if (mode >= 2) {\n        if (notePlaying[layer]) return;\n        notePlaying[layer] = true;\n        samplerShort.connect(filter).triggerAttack(note);\n        setTimeout(()=>{\n            notePlaying[layer] = false;\n        }, noteDuration);\n        return;\n    }\n    \n    if (d.layer <= layerInner) {\n        if (mode >= 2) samplerShort.triggerAttack(note);\n        else {\n            let membrane = new Tone.MembraneSynth ({\n                pitchDecay  : 0.001 ,\n                octaves  : 2,\n                oscillator  : {\n                type  : 'sine'\n                }  ,\n                envelope  : {\n                attack  : 0.1 ,\n                decay  : 0.5 ,\n                sustain  : 0.05 ,\n                release  : 1.4 ,\n                attackCurve  : 'exponential'\n                }\n                }).chain(finalFilter);\n                //d.layer*Tone.Frequency('C4')\n            membrane.triggerAttackRelease(note, 1);\n        }\n\n        return;\n    }\n    // if (d.layer > layerOuter) {\n    //     let env = new Tone.AmplitudeEnvelope({\n    //         attack: 0.4,\n    //             attackCurve: 'sine',\n    //             decay: 0,\n    //             sustain: 1,\n    //             release: 0.5,\n    //             releaseCurve: 'sine'\n    //       }).toMaster();\n          \n    //       let osci = new Tone.FatOscillator({\n    //         type: 'sine',\n    //         spread: 20,\n    //         count: 10,\n    //       }).start().connect(env);\n    //       osci.freq = note;\n    //       env.triggerAttackRelease(1);\n    //     return;\n    // }\n    if (noteTimeout[layer]) {\n        clearTimeout(noteTimeout[layer]);\n        setTimeout(()=>{setRelease(layer)}, noteDuration);\n        return;\n    }\n    \n    console.log(layer, note, freq);\n    //freq\n    \n    // var fmSynth = new Tone.FMSynth().chain(filter, reverb, comp);\n    // fmSynth.triggerAttackRelease(note, 0.15);\n    setAttackRelease(filter, layer, note);\n\n    \n    \n}\n\nlet triggerActive = (note) => {\n    let synth = new Tone.PolySynth(5, Tone.Synth, {\n        oscillator : {\n            type: 'sawtooth',\n            partials : [1, 0.34, 0.67, 1],\n            partialCounts: 5,\n        },\n        envelop: {\n          attack: 0.01,\n          decay: 1.2,\n          decayCurve: 'exponential',\n          sustain: 0,\n          release: 0.3\n        }\n    }).connect(finalFilter);\n    synth.triggerAttackRelease(note, noteDuration/1000);\n}\n\nlet triggerMetal = (frequency, resonance, harmonicity) => {\n    // frequency = Math.max(Math.min(100, frequency), Tone.Frequency('C6'));\n    // let metal = new Tone.MetalSynth({\n    //     frequency  : frequency,\n    //     envelope  : {\n    //     attack  : 0.01 ,\n    //     decay  : 0.4 ,\n    //     release  : 0.2\n    //     },\n    //     harmonicity  : harmonicity,\n    //     modulationIndex  : 20,\n    //     resonance  : resonance,\n    //     octaves  : 1.5\n    //     }\n    // ).connect(reverb);\n    // metal.envelope.decayCurve = 'exponential';\n    // metal.triggerAttackRelease(0.4);\n    \n}\n\nlet setAttackRelease = (filter, ind, note) => {\n    //(noteSynth[note].chain(filter, reverb, comp)).triggerAttack(note);\n    (noteSynth[ind].chain(filter,finalFilter)).triggerAttack(note);\n    noteTimeout[ind] = setTimeout(()=>{\n        setRelease(ind);\n    }, noteDuration);\n}\n\nlet setRelease = (ind) => {\n    noteSynth[ind].triggerRelease();\n    noteTimeout[ind] = null;\n}\n\nlet scaleNumber = (number) => {\n    number = Math.floor(Math.pow(number, 1/1) + Math.floor(Math.random()*3) -1) - 1;\n    return Math.max(Math.min(number, noteNumber-1), 0);\n    //not sure if i need to use max(..,0);\n}\n\nlet getNote = (number) => {\n    let len = octave.length;\n    return octave[number%len]+\n        Math.min(octaveMax, Math.floor(octaveStart+number/len));\n}\n\nlet getFreq = (number) => {\n    return calculateFreq(startFreq, number*noteBetween);\n}\n\nlet calculateFreq = (freq, half) => {\n    return freq * Math.pow(2, half/12.0);\n}\n\nexport let makesound = () => {\n    let temp = new Tone.Synth().toMaster();\n    temp.volume.value = -60;\n    temp.triggerAttackRelease('C4', '16n');\n}","import {receiveOSC, emitOSC, isSocketConnect} from './socketUsage';\nimport {initSound, triggerSound} from './sound';\n//import {earthLocRef} from './firebase';\n\nexport default function sketch (p) {\n    let radioDeg = 0;\n    let lastRadioDeg = 0;\n    let allDataPoint = [];\n    let dataPoint = [];\n    let configData = {};\n    let enableUpdate = true;\n    let lightCounter = 0;\n    let rDistArr = [];\n    let myId;\n    let testBtn;\n\n    receiveOSC((data)=>{\n        if (data.address==\"/gps/trigger\"){\n            let scanId = JSON.parse(data.args[0].value).id\n            // console.log(scanId)\n            if (scanId == myId){\n                lightCounter = 0;\n            }\n        }\n    });\n\n    p.setup = () => {\n        p.createCanvas(p.windowWidth, p.windowHeight);\n        p.frameRate(30);\n        console.log('issocketConnect:' + isSocketConnect);\n        initSound();\n        // for test\n        testBtn = p.createButton('yo');\n        testBtn.position(19, 19);\n        testBtn.mousePressed(()=>{\n            triggerSound({layer:30, leave: false});\n        })\n    };\n\n    p.windowResized = () =>  {\n        p.resizeCanvas(p.windowWidth, p.windowHeight);\n    }\n\n    p.myCustomRedrawAccordingToNewPropsHandler = (props) => {\n        if (props.configData) {\n            configData = props.configData;\n            calcRdistArr();\n        }\n        if (props.dataPoint && Object.keys(configData).length !== 0){\n            allDataPoint = props.dataPoint;\n            updateDataPoint();\n        }\n        if (props.myId) {\n            console.log(props.myId);\n            myId = props.myId;\n        }\n    };\n\n    let dataPointMap = (e) => {\n        let pos = getPos(p, configData, e);\n        let dist = pos.mag().toFixed(5)*1.0;\n        let deg = (pos.heading()/Math.PI*180).toFixed(5)*1.0;\n        return {...e, pos: pos, dist: dist, degree: deg}\n    }\n\n    let updateDataPoint = () => {\n        console.log('updateDataPoint');\n        let num = p.int(p.frameCount / 4);\n        if (num) {\n            let threshold = calcR(10, configData.globalScale, configData.globalPow);\n            dataPoint = allDataPoint.slice(-num).map(dataPointMap).filter((e) => e.dist < threshold);\n        }\n        enableUpdate = num > allDataPoint.length ? false : true;\n    }\n\n    let calcRdistArr = () => {\n        for (let i=0; i<50; i++) {\n            rDistArr[i] = calcR(i, configData.globalScale, configData.globalPow);\n        }\n    }\n\n\n    p.draw = function () {\n        if (p.frameCount % 25 === 0 && enableUpdate){\n            updateDataPoint();\n        }\n        lastRadioDeg = radioDeg;\n        radioDeg = calcDeg(configData.radioSpeed, p.frameCount);\n\n        //emit radio\n        if (p.frameCount % 30 === 0)\n            emitOSC('/gps/radio', (radioDeg/Math.PI*180).toFixed(5)*1.0)\n\n        lightCounter++;\n        p.background(255/lightCounter, 100);\n        p.textSize(12)\n        p.fill(255)\n        p.stroke(255,10)\n        p.strokeWeight(1)\n        \n        let text = `Total Nodes: ${calcPerson(dataPoint)}\\nActive: ${calcActive(dataPoint)}\\nExecute Time: ${p.frameCount}\\nScanning: ${(radioDeg/Math.PI*180).toFixed(2)}°`\n        drawText(p, text);\n        //將繪製點移動到畫布中央\n        p.translate(p.width/2, p.height/2);\n        drawCircle(p, rDistArr);\n        drawDataPoint(p, dataPoint, radioDeg, lastRadioDeg, configData);\n        \n        p.noFill()\n        drawSwipeLine(p, radioDeg);\n        drawCenter(p, configData.centerName);\n        drawMapFrame(p);\n        drawSecRect(p);\n    };\n};\n\nfunction drawSecRect(p) {\n    let sec = new Date().getSeconds();\n    p.fill(255);\n    p.rect(-p.width/2+(sec % 5)*30+20,p.height/2-75,25,6);\n    p.stroke(255);\n    p.noFill();\n    p.rect(-p.width/2+( (sec+1) % 5)*30+20,p.height/2-75,25,6);\n}\n\nfunction drawMapFrame(p) {\n    p.push();\n        p.stroke(255,255);\n        p.strokeWeight(10);\n        p.rect(-p.width/2,-p.height/2, p.width, p.height);\n        p.strokeWeight(1);\n        p.stroke(255,30);\n        \n        p.rect(-p.width/2+10,-p.height/2+10, p.width-20, p.height-20);\n    \n        p.stroke(255,255);\n        p.strokeWeight(2);\n        p.line(-p.width/2,0,-p.width/2+20,0);\n        p.line(p.width/2,0,p.width/2-20,0);\n    \n        p.line(0,-p.height/2,0,-p.height/2+20);\n        p.line(0,p.height/2,0,p.height/2-20);\n    \n        p.noStroke();\n        p.fill(255,200);\n        p.textAlign(p.CENTER);\n        p.text('W',-p.width/2+20+15,5);\n        p.text('E',p.width/2-20-15,5);\n        p.text('N',0,-p.height/2+20+20);\n        p.text('S',0,p.height/2-20-10);\n    p.pop();\n}\n\nfunction drawCenter(p, centerName) {\n    p.push();\n        p.fill(\"#f24\");\n        p.noStroke();\n        p.ellipse(0,0,8,8);\n        p.rectMode(p.CENTER);\n        p.stroke(255);\n        p.noFill();\n        p.strokeWeight(2);\n        p.rect(0,0,20,20);\n    \n    \n        p.rotate(p.frameCount/100);\n        p.stroke(255,20);\n        p.rect(0,0,20,20);\n    p.pop();\n\n    p.push();\n        p.fill(255,200);\n        p.text(centerName, 20, 12);\n    p.pop();\n}\n\nfunction drawSwipeLine(p, radioDeg) {\n    p.push()\n        p.stroke(255,200)\n        p.strokeWeight(2)\n        p.line(0,0,Math.cos(radioDeg)*1000, Math.sin(radioDeg)*1000)\n        p.noStroke()\n        let degSpan = 20\n        for(var i=0;i < degSpan;i++){\n            p.fill(255,50/ degSpan*(degSpan-i) )\n            p.beginShape()\n            p.vertex(0,0)\n            p.vertex(Math.cos(radioDeg-0.02*(i-1))*1000,Math.sin(radioDeg-0.02*(i-1))*1000)\n            p.vertex(Math.cos(radioDeg-0.02*i)*1000,Math.sin(radioDeg-0.02*i)*1000)\n            p.endShape(p.CLOSE)\n        }\n    p.pop()\n}\n\nfunction drawDataPoint(p, dataPoint, radioDeg, lastRadioDeg, configData) {\n    p.textSize(12)\n    p.fill(255)\n    p.stroke(255,10)\n    p.strokeWeight(1)\n    let lastTrigger;\n    dataPoint.forEach(( e, eid)=>{\n        let timeDelta = Date.now()- e.timeStamp;\n        let dataDegree = e.pos.heading();\n        let angleDelta = -1000\n        let nowId = e.showId;\n        if (!e.pos) {\n            console.log('no position?');\n            return;\n        }\n        angleDelta = dataDegree - radioDeg;\n        let scanned = ((lastRadioDeg - dataDegree) * (radioDeg - dataDegree) <= 0)\n                        && Math.abs(lastRadioDeg - radioDeg) < 1;\n        \n        if (scanned){\n            if (lastTrigger !== e){\n                //console.log(e);\n                \n               \n                let d = {  \n                    //layer: Math.ceil(Math.pow(e.dist/0.5, 1/configData.globalPow)*10/configData.globalScale),\n                    //layer: Math.ceil(Math.pow(e.dist/0.5, 1/configData.globalPow)*10/configData.globalScale),\n                    layer: calcReverseR(e.dist, configData.globalScale, configData.globalPow),\n                    degree: e.degree,\n                    dist: e.dist,\n                    leave: e.leave,\n                    pos: e.pos,\n                }\n                let d2 = JSON.stringify({\n                    degree: e.degree,\n                    dist: e.dist,\n                    layer: d.layer,\n                    id: e.key,\n                    data: e.data,\n                    leave: e.leave,\n                    timeStamp: e.timeStamp,\n                    time_to_now_second: timeDelta,\n                })\n                triggerSound(d);\n                emitOSC('/gps/trigger', d2);\n            }\n            lastTrigger = e;\n        }\n\n        p.push()\n        let dist = e.pos.mag()\n\n        //draw line\n        if (dist < p.width * 2){\n            p.noFill()\n            p.beginShape()\n            for(var o=0; o < dist-10; o+=2){\n                let useAngle = dataDegree + p.noise(p.frameCount/10+ o/10)/60\n                p.vertex(Math.cos(useAngle)*o, Math.sin(useAngle)*o)\n                // line(o,o,a.pos.x*0.95,a.pos.y*0.95)\n            }\n            p.endShape()\n        }\n        p.pop()\n                \n        let scanAfter = Math.abs(angleDelta % (Math.PI*2) ) < 0.08 && angleDelta < 0\n        if (scanAfter){\n            \n            p.push()\n                p.fill(0,0,0,70)\n                p.noStroke()\n                p.rect(e.pos.x+6,e.pos.y-5, p.textWidth(nowId)+8,12)\n                p.fill(255)\n                p.text(nowId, e.pos.x+10, e.pos.y+5)\n            p.pop()\n        }\n           \n        if (!scanned){\n            p.fill(255, 5+150/Math.log(timeDelta) + (scanAfter ? 50 : 0))  \n        } else{\n            p.fill(255)\n        }\n        \n        //繪製正在線上的點\n        let useR = 5 + (angleDelta<0?Math.max(Math.min(-1/(angleDelta),6),0):0) + p.noise(eid, p.frameCount, e.lon)*2\n\n        if (!e.leave){\n            p.fill(255,0,0)\n            //p.text(this.uid, 0, 30)\n            useR= 5+ Math.sin(p.frameCount/10)*2\n            p.push()\n                p.stroke(255,200)\n                p.rectMode(p.CENTER)\n                p.translate(e.pos.x,e.pos.y)\n                p.rotate(p.frameCount/(10+ e.lon/100))\n                p.noFill()\n                p.rect(0,0,12,12)\n            p.pop()\n            p.text(`//ACTIVE ${(p.frameCount % 10 <5?\".\":\"\")}\\nID: ${nowId}`, \n                e.pos.x+10, e.pos.y+20)\n        }\n        p.ellipse(e.pos.x, e.pos.y, useR, useR)\n      })\n}\n\nfunction calcR(i, globalScale, globalPow) {\n    return Math.pow(Math.abs(i * globalScale / 10), globalPow)*0.5;\n}\n\nfunction calcReverseR(dist, globalScale, globalPow) {\n    return Math.pow(dist/0.25, 1/globalPow)*10/globalScale;\n  //return Math.ceil(Math.pow(dist/0.25, 1/globalPow)*10/globalScale);\n}\n\nfunction drawCircle(p, rDistArr) {\n    let frameCount = p.frameCount;\n    p.noFill();\n    for(let i=0;i<50;i++){\n        //let r = Math.pow(Math.abs(i * globalScale / 10), globalPow) * 0.5\n        let r = 0;\n        if (rDistArr.length > i) r = rDistArr[i];\n        //else r = calcR(i, globalScale, globalPow);\n        p.stroke(255, Math.max(60-i/10*60,4) + Math.sin(-frameCount/10+i)*4)\n        if (i<9){\n            p.fill(255,255,255,1 + p.noise(frameCount/10,i)*1)\n            p.stroke(255,20)\n            p.beginShape(p.LINES)\n    \n            for(let o=0; o<360; o++){\n                let useR = calcWaveR(r, frameCount, i, o, 50/(10-i));\n                p.vertex(useR*Math.cos(p.radians(o+frameCount/40)),useR*Math.sin(p.radians(o+frameCount/40)) )\n            }\n            p.endShape()\n          \n            p.noStroke()\n            //用 close 填內容色\n            p.beginShape()\n            for(let o=0;o<360;o++){\n                let useR = calcWaveR(r, frameCount, i, o, 30/(8-i));\n                p.vertex(useR*Math.cos(p.radians(o+frameCount/40)),useR*Math.sin(p.radians(o+frameCount/40)) )\n            }\n            p.endShape(p.CLOSE)\n\n        } else{\n            p.noFill()\n            p.ellipse(0,0,r,r)\n\n        }\n    }  \n}\n\nfunction drawText(p, text) {\n    //Draw Date Text \n    p.push();\n    p.fill(255);\n    p.textSize(14);\n    p.textLeading(24);\n    p.text(new Date(), 20, p.height-35);\n    p.pop();\n\n    //Show Number of Person\n    //TODO: Calculate Person\n    p.push();\n        p.fill(255,130);\n        p.text(text, 20, 35);\n        //p.text(\"Total Nodes: \"+calcPerson() + \"\\nActive: \" + allActiveCount + \"\\nExecute Time: \" + frameCount+\"\\nScanning: \"+parseFloat( radioDeg/PI*180).toFixed(2)+\"°\", 20, 35)\n    p.pop();\n}\n\nfunction calcWaveR(r, frameCount, i, o, mult) {\n    return r/2 + Math.sin(frameCount/(10+i*10)+o/360*2*Math.PI*10)*mult;\n}\n\nfunction calcDeg(radioSpeed, frameCount) {\n    return (radioSpeed * frameCount / 60) % (2*Math.PI) - Math.PI;\n}\n\nfunction getPos(p, configData, obj){\n\n    if (obj.lon && obj.lat){\n      let lon = (obj.lon-configData.lon)*configData.globalScale\n      let lat = (obj.lat-configData.lat)*configData.globalScale\n      let result= p.createVector(lon,lat)\n      result.x = (result.x>0?1:-1)* Math.pow(Math.abs(result.x),configData.globalPow)\n      result.y =  (result.y>0?1:-1)* Math.pow(Math.abs(result.y),configData.globalPow)\n      result.y*=-1\n      return result\n    } \n    return null\n}\n\nfunction calcPerson(dataPoint) {\n    return dataPoint.length;\n}\n\nfunction calcActive(dataPoint) {\n    return dataPoint.filter(e => !e.leave).length;\n}","import * as firebase from 'firebase';\nimport {firebaseConfig} from './config';\n//copy firebaseConfig from firebase website\n\n// Initialize Firebase\nfirebase.initializeApp(firebaseConfig);\nconst databaseRef = firebase.database().ref();\nexport const earthLocRef = databaseRef.child('earthlocations');","let gpsPermission = null;\nexport let gpsData = {};\nlet id;\nlet watchCallBack = null;\nexport let setupGPS = (callback) => {\n    watchCallBack = callback;\n    console.log('setup gps');\n    let options = {\n      enableHighAccuracy: true,\n      timeout: 60000,\n      maximumAge: Infinity\n    };\n    id = navigator.geolocation.watchPosition(showPosition, watchPositionError);\n}\nexport let gpsHelp = getSettingStr();\n\nfunction showPosition(position) {\n    console.log('yo!');\n    gpsPermission = true;\n    gpsData = {\n        lat: position.coords.latitude,\n        lon: position.coords.longitude,\n        timeStamp: Date.now(),\n        date: Date(Date.now()),\n        leave: false\n    }\n    watchCallBack(true);\n}\n    \nfunction watchPositionError(positionError)  {\n   \n    console.log('fail!'+gpsHelp);\n    gpsPermission = false;\n    switch (positionError.code) {\n        // PERMISSION_DENIED\n        case 1:\n          console.log('Permission denied')\n          break\n        // POSITION_UNAVAILABLE\n        case 2:\n          console.log('Permission allowed, location disabled')\n          break\n        // TIMEOUT\n        case 3:\n          console.log('Permission allowed, timeout reached')\n          break\n        default:\n          break;\n    }\n    watchCallBack(false);\n}\n\nfunction getSettingStr() {\n  var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n    if (/android|windows phone/i.test(userAgent)) {\n      return \"1. Open the Chrome app.\\n\\n2. Find and tap Settings.\\n\\n3. Tap Site settings > Location.\\n\\n4. Turn Location on.\";\n    }\n    // iOS detection from: http://stackoverflow.com/a/9039885/177710\n    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {\n      return \"1. Open the settings app.\\n\\n2. Find and tap Safari/Chrome.\\n\\n3. Tap Location.\\n\\n4. Select \\\"While Using the App\\\".\";\n    }\n    return \"Enable Location Permission\";\n}\n\nexport let clearWatchGPS = () => {\n  navigator.geolocation.clearWatch(id);\n}","import React, {useState, useEffect} from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport {makesound} from './sound';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './BlackModal.css';\n\nexport function NameModal(props) {\n    const [show, setShow] = useState(props.show);\n    const [name, setName] = useState(\"\");\n    const handleClose = () => {\n        makesound();\n        setShow(false);\n        if (name !== \"\")\n            props.onChange(name, true);\n    }\n    useEffect(()=>{\n        if (props.show)\n            setShow(true);\n    },[props.show]);\n  \n    return (\n      <>\n        {/* <Button variant=\"primary\" onClick={handleShow}>\n          Launch demo modal\n        </Button> */}\n  \n        <Modal show={show} \n                centered={true}\n                dialogClassName={'black-modal-dialog'}\n                backdropClassName={'black-modal-backdrop'}>\n            <Modal.Body bsPrefix={'black-modal-body'}>\n                <label htmlFor=\"name\">Name your session</label> <br/>\n                <input id=\"name\" type=\"text\" placeholder={props.name} \n                    value={name} onChange={e => setName(e.target.value)}></input>\n                <span className=\"hint\"> ⚠ 完整呈現作品，請打開聲音及定位。</span>           </Modal.Body>\n            <Modal.Footer bsPrefix={'black-modal-footer'}>\n                <Button variant=\"dark\" size=\"sm\" onClick={handleClose}>\n                    Default\n                </Button>\n                <Button variant=\"light\" size=\"sm\" onClick={handleClose}>\n                    Save\n                </Button>\n            </Modal.Footer>\n        </Modal>\n      </>\n    );\n}\n","import React, {useState} from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './BlackModal.css';\n\nexport function IntroModal(props) {\n    const [show, setShow] = useState(props.show);\n\n    const handleClose = () => {\n        setShow(false);\n    }\n    const handleShow = () => {\n        setShow(true);\n    }\n  \n    return (\n      <>\n        <Button onClick={handleShow} bsPrefix=\"intro-button\">\n            i\n        </Button>\n  \n        <Modal show={show} onHide={handleClose}\n                centered={true}\n                dialogClassName={'black-modal-dialog'}\n                backdropClassName={'black-modal-backdrop'}>\n            <Modal.Header closeButton bsPrefix={'black-modal-header'}>\n                \n            </Modal.Header>\n            <Modal.Body bsPrefix={'black-modal-body'}>\n                <h6>距離之歌<br/><span class='eng-hint'>Song of Distance</span></h6><br/>\n                <p>「距離之歌」是一件將使用者定位資料轉化為樂音的生成式音樂系統。系統將不斷掃描周圍所的連線裝置，同時也將您的裝置座標提供給其他裝置。</p>               \n            </Modal.Body>\n        </Modal>\n      </>\n    );\n}\n","import React, {useState, useEffect} from 'react';\nimport Modal from 'react-bootstrap/Modal';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './BlackModal.css';\nimport setting from './img/Settings-icon.png';\n\nexport function LocHintModal(props) {\n    const [show, setShow] = useState(props.show);\n    const [os] = useState(()=>{\n        var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n        if (/android|windows phone/i.test(userAgent)) {\n            return 0;\n        }\n        // iOS detection from: http://stackoverflow.com/a/9039885/177710\n        if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {\n            return 1;\n        }\n        return 2;\n    })\n\n    useEffect(()=>{\n        setShow(props.show);\n    },[props.show]);\n\n    return (\n      <>  \n        <Modal show={show}\n                centered={true}\n                dialogClassName={'black-modal-dialog'}\n                backdropClassName={'black-modal-backdrop'}>\n            <Modal.Header bsPrefix={'black-modal-header'}>\n                \n            </Modal.Header>\n            <Modal.Body bsPrefix={'black-modal-body'}>\n                <h6>\n                <span className=\"zh-tw-hint\">為了作品的完整呈現，請允許使用定位功能</span>\n                <span className=\"eng-hint\">Enable location permission for the best experience.</span>\n                </h6>\n                {os===0 && <IOSHint/>}  \n                {os===1 && <AndroidHint/>}   \n            </Modal.Body>\n        </Modal>\n      </>\n    );\n}\n\nfunction IOSHint() {\n    return (<>\n        \n        <ol>\n            <li>\n                <span class=\"zh-tw-hint\">開啟<img src={setting} alt=\"Settings\"/>「設定」應用程式。</span>\n                <span class=\"eng-hint\">Open the \"Settings\" app</span>\n            </li>\n            <li>\n                <span class=\"zh-tw-hint\">點選使用的瀏覽器。</span>\n                <span class=\"eng-hint\"> Find and tap \"Safari\" or \"Chrome\"</span>\n            </li>\n            <li>\n                <span class=\"zh-tw-hint\">輕觸「位置」。</span>\n                <span class=\"eng-hint\">Tap \"Location\"</span>\n            </li>\n            <li>\n                <span class=\"zh-tw-hint\">選擇「使用 App 期間」。</span>\n                <span class=\"eng-hint\">Select \"While Using the App</span>\n            </li>\n        </ol>\n    </>);\n}\n\nlet grayStyle = {color:\"gray\",\n                fontWeight:\"bolder\"};\nfunction AndroidHint(props) {\n    return (<>\n        \n        <ol>\n            <li>\n                <span class=\"zh-tw-hint\">開啟Chrome應用程式。</span>\n                <span class=\"eng-hint\">Open the \"Chrome\" app.</span>\n            </li>\n            <li>\n                <span class=\"zh-tw-hint\">點選「設定」。</span>\n                <span class=\"eng-hint\"> Find and tap \"Settings\"</span>\n            </li>\n            <li>\n                <span class=\"zh-tw-hint\">輕觸「網站設定」\n                    <span style={grayStyle}>></span>「定位」。</span>\n                <span class=\"eng-hint\">Tap \"Site settings\" <span style={grayStyle}>></span> \"Location\"</span>\n            </li>\n            <li>\n                <span class=\"zh-tw-hint\">將定位開啟。</span>\n                <span class=\"eng-hint\">Turn Location on</span>\n            </li>\n        </ol>\n    </>);\n}","import React, {Component} from 'react';\nimport P5Wrapper from 'react-p5-wrapper';\nimport sketch from './sketch';\nimport {earthLocRef} from './firebase';\nimport * as dat from 'dat.gui';\nimport {gpsData, setupGPS} from './gps';\nimport {NameModal} from './NameModal';\nimport {IntroModal} from './IntroModal';\nimport { LocHintModal } from './LocHintModal';\n\nconst SESSION_ID = 'generative_geo_id';\nconst SESSION_NAME = 'generative_name';\nconst SESSION_TIME = 'generative_geo_id_time';\n\nclass LocData extends Component {\n    state = {\n        gp: {},\n        gpsPermission: null,\n        //allLocations: [],\n        dataPoint: []\n    }\n    gpsPermit = (b) => {\n        this.setState({gpsPermission: b});\n    }\n\n    componentDidMount() {\n        //this.initGPS();\n        console.log('setupGPS');\n        setupGPS(this.gpsPermit);\n        earthLocRef.on('value', (snapshot) => {\n            //console.log(snapshot.val());\n            // this.setState({\n            //     allLocations: snapshot.val()\n            // });\n            //getAll();\n            this.updateDataSet(snapshot.val());\n        });\n    }\n\n    initGPS = () => {\n        \n    }\n\n    updateDataSet = (allLocations) => {\n        console.log('updateDataset');\n        \n        this.checkData(allLocations);\n        this.setState({\n            // dataPoint: Object.entries(this.state.allLocations).map(d => \n            dataPoint: Object.entries(allLocations)\n            .filter(d=> {\n                return d[0] !== gpsData.key})\n            .map(d => \n                ({...d[1], key: d[0]}))\n        })\n        \n    }\n\n    checkData = (allLocations) => {\n        //should be removed....\n        Object.entries(allLocations).forEach((e)=>{\n            //如果沒有 key 補上\n            if (!('key' in e[1])) {\n                earthLocRef.child(e[0]).child('key').set(e[0]);\n            }\n            //如果沒有 showId 補上\n            if (!('showId' in e[1]) && e[0] ){\n                earthLocRef.child(e[0]).child(\"showId\").set(getShowId(e[0]))\n            }\n            //如果沒有時間戳或位置資料，移除該資料\n            if (!e[1].timeStamp || !e[1].lat || !e[1].lon){\n                earthLocRef.child(e[0]).remove()\n            } else { //check offline\n                let timeDelta = Date.now()-e[1].timeStamp\n                //如果已離線>6秒，設定為離線\n                if (timeDelta > 6000){\n                    if (!e[1].leave){\n                        earthLocRef.child(e[0]).child('leave').set(true)\n                    }\n                } else{\n                    //如果沒有，設定為活躍\n                    if (e[1].leave){\n                        earthLocRef.child(e[0]).child('leave').set(false)    \n                    }\n                }\n            }\n        })\n    }\n\n     \n\n    render() {\n        let {gpsPermission} = this.state;\n        return (<>\n            <LocHintModal show={gpsPermission===false}/>\n            <IntroModal show={false}/>\n            {gpsPermission && <ControlPanel dataPoint={this.state.dataPoint}/>}\n            </>\n        );\n    }\n}\n\nclass ControlPanel extends Component {\n    state = {\n        data: {\n            globalScale: Math.pow(10, 10),\n            globalPow: 0.3,\n            maxLineLength: 100,\n            radioSpeed: 0.5/2*Math.PI,\n            lat: gpsData.lat,\n            lon: gpsData.lon,\n            centerName: 'center'\n        }, \n        name: 'center',\n        naming: false\n        //GUI: new dat.GUI()\n    }\n\n    componentDidMount() {\n        window.addEventListener(\"beforeunload\", this.handleWindowBeforeUnload);\n        this.addGPSKey();\n        this.setState({naming: true});\n        //let dataStore = sessionStorage.getItem('controlData');\n        //console.log(dataStore);\n        //let {data, GUI} = this.state;\n        //if (dataStore) {\n        // data = JSON.parse(dataStore);\n        //     this.setState({\n        //         data: data\n        //     })\n        //} \n        // const btn = {'add config': this.saveControlData};\n        // GUI.add(data,\"globalScale\",1000,800000)\n        // GUI.add(data,\"globalPow\",0,0.99)\n        // GUI.add(data,\"maxLineLength\")\n        // GUI.add(data,'radioSpeed',0,3,0.01)\n        // GUI.add(data,'centerName')\n        // GUI.add(data,'lat',-90,90,0.01)\n        // GUI.add(data,'lon',-180,180,0.01)\n        // GUI.add(btn, 'add config');\n\n        // GUI.close()\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"beforeunload\", this.handleWindowBeforeUnload);\n    }\n\n    addGPSKey = () => {\n        let myId;\n        let lastId = localStorage.getItem(SESSION_ID)\n        let lastIdTime = localStorage.getItem(SESSION_TIME)\n        let showId = localStorage.getItem(SESSION_NAME)\n        if (lastId && (Date.now() - lastIdTime < 60*60*1000)){\n            console.log(\"Old Id Detected! use \" + lastId)\n            myId = lastId\n            localStorage.setItem(SESSION_TIME, Date.now())\n        } else{\n            myId = earthLocRef.push(gpsData).key;\n            showId = getShowId(myId);\n            console.log(\"Generate new id \" + myId)\n            localStorage.setItem(SESSION_ID,myId)\n            localStorage.setItem(SESSION_TIME, Date.now())\n        }\n        \n        gpsData.key = myId;\n        console.log(gpsData.key);\n        if (!showId)\n            showId = getShowId(myId);\n        gpsData.showId = showId;\n        earthLocRef.child(myId).set(gpsData);\n        this.changeCenterName(showId, false);\n    }\n\n    changeCenterName = (name, updateFirebase) => {\n        localStorage.setItem(SESSION_NAME, name);\n        if (updateFirebase && gpsData.key) \n            earthLocRef.child(gpsData.key).child('showId').set(name);\n        this.setState({data:{...this.state.data, centerName: name}, name: name});\n    }\n    \n    saveControlData = () => {\n        let {data} = this.state;\n        sessionStorage.setItem('controlData', JSON.stringify({...data}));\n    }\n\n    handleWindowBeforeUnload = (e) => {\n        earthLocRef.child(gpsData.key).child('leave').set(true);\n        return;\n    }\n\n    render() {\n        const {data} = this.state;\n        let {dataPoint} = this.props;\n\n        return (\n            <>\n            <NameModal show={this.state.naming} name={data.centerName} \n                        onChange={this.changeCenterName}/>\n            <P5Wrapper sketch={sketch} dataPoint={dataPoint}\n                    configData={data} myId={gpsData.key}/>\n            </>\n        )\n\n\n    }\n\n}\n\nconst getShowId = (id) => {\n    return \"A\" + (id.split(\"\").map(ch=>ch.charCodeAt(0)).reduce((a,b)=>(a*b),1) % 1000)\n  }\n\nexport default LocData;","import React from 'react';\nimport LocData from './ControlPanel';\nimport './App.css';\n\n\nclass App extends React.Component {\n  \n  render() {\n    return (\n      <LocData/>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","module.exports = __webpack_public_path__ + \"static/media/C3_mid_long_44.1k.07d4d97c.mp3\";","module.exports = __webpack_public_path__ + \"static/media/C2_low_short_44.1k.9d4cbcaa.mp3\";","module.exports = __webpack_public_path__ + \"static/media/Settings-icon.43d7547b.png\";"],"sourceRoot":""}