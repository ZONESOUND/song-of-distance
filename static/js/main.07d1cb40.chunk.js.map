{"version":3,"sources":["socketUsage.js","config.js","sound.js","sketch.js","firebase.js","gps.js","NameModal.js","ControlPanel.js","App.js","index.js"],"names":["socket","io","isSocketConnect","on","console","log","synth","receiveOSC","func","initSound","Tone","Synth","oscillator","type","envelope","attack","decay","sustain","release","toMaster","triggerSound","d","triggerAttackRelease","getNote","layer","number","len","length","Math","min","floor","sketch","p","myId","radioDeg","lastRadioDeg","allDataPoint","dataPoint","configData","enableUpdate","lightCounter","rDistArr","data","address","JSON","parse","args","value","id","setup","createCanvas","windowWidth","windowHeight","frameRate","windowResized","resizeCanvas","myCustomRedrawAccordingToNewPropsHandler","props","alert","centerName","calcRdistArr","name","Object","keys","updateDataPoint","dataPointMap","e","pos","obj","lon","lat","globalScale","result","createVector","x","pow","abs","globalPow","y","getPos","dist","mag","toFixed","deg","heading","PI","degree","num","int","frameCount","map","slice","i","calcR","draw","radioSpeed","background","textSize","fill","stroke","strokeWeight","text","calcPerson","filter","leave","calcActive","push","textLeading","Date","height","pop","drawText","translate","width","noFill","r","max","sin","noise","beginShape","LINES","o","useR","calcWaveR","vertex","cos","radians","endShape","noStroke","CLOSE","ellipse","drawCircle","lastTrigger","forEach","eid","angleDelta","timeDelta","now","timeStamp","dataDegree","nowId","showId","scanned","calcReverseR","useAngle","scanAfter","rect","textWidth","rectMode","CENTER","rotate","drawDataPoint","line","drawSwipeLine","drawCenter","textAlign","drawMapFrame","sec","getSeconds","drawSecRect","ceil","mult","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","earthLocRef","ref","child","gpsPermission","gpsData","gpsHelp","userAgent","navigator","vendor","window","opera","test","MSStream","getSettingStr","showPosition","position","coords","latitude","longitude","date","watchPositionError","positionError","code","NameModal","useState","show","setShow","setName","handleClose","onChange","Modal","centered","dialogClassName","backdropClassName","Body","bsPrefix","htmlFor","placeholder","target","Footer","Button","variant","size","onClick","SESSION_ID","SESSION_NAME","SESSION_TIME","LocData","state","gp","allLocations","initGPS","updateDataSet","setState","entries","key","checkData","set","getShowId","remove","geolocation","watchPosition","snapshot","val","this","Component","ControlPanel","maxLineLength","addGPSKey","lastId","localStorage","getItem","lastIdTime","setItem","changeCenterName2","updateFirebase","changeCenterName","saveControlData","sessionStorage","stringify","handleWindowBeforeUnload","addEventListener","removeEventListener","split","ch","charCodeAt","reduce","a","b","App","React","ReactDOM","render","document","getElementById"],"mappings":"sRAGMA,E,MAASC,GCMS,kBDLpBC,GAAkB,EACtBF,EAAOG,GAAG,WAAW,WACjBD,GAAkB,EAClBE,QAAQC,IAAI,+BAGT,IENHC,EFeOC,EAAa,SAACC,GACrBR,EAAOG,GAAG,MAAOK,I,iBEdVC,EAAY,WACnBH,EAAQ,IAAII,IAAKC,MAAM,CACnBC,WAAa,CAACC,KAAK,QACnBC,SAAW,CACPC,OAAQ,GACRC,MAAO,GACPC,QAAS,GACTC,QAAS,MACTC,YAGDC,EAAe,SAACC,GACvBf,EAAMgB,qBAAqBC,EAAQF,EAAEG,OAAQ,QAG7CD,EAAU,SAACE,GACX,IAAIC,EArBK,UAqBQC,OACjB,MAtBS,UAsBKF,EAAOC,GACjBE,KAAKC,IArBG,EAqBYD,KAAKE,MAtBf,EAsBiCL,EAAOC,K,8NCpB3C,SAASK,EAAQC,GAC5B,IAQIC,EARAC,EAAW,EACXC,EAAe,EACfC,EAAe,GACfC,EAAY,GACZC,EAAa,GACbC,GAAe,EACfC,EAAe,EACfC,EAAW,GAIflC,GAAW,SAACmC,GACU,gBAAdA,EAAKC,UACQC,KAAKC,MAAMH,EAAKI,KAAK,GAAGC,OAAOC,IAE9Bf,IACVO,EAAe,OAK3BR,EAAEiB,MAAQ,WACNjB,EAAEkB,aAAalB,EAAEmB,YAAanB,EAAEoB,cAChCpB,EAAEqB,UAAU,IACZjD,QAAQC,IAAI,mBAAqBH,GACjCO,KASJuB,EAAEsB,cAAgB,WACdtB,EAAEuB,aAAavB,EAAEmB,YAAanB,EAAEoB,eAGpCpB,EAAEwB,yCAA2C,SAACC,GACtCA,EAAMnB,aACNoB,MAAMD,EAAMnB,WAAWqB,YACvBrB,EAAamB,EAAMnB,WACnBsB,KAEAH,EAAMI,OACNH,MAAM,UAAUD,EAAMI,MACtBvB,EAAWqB,WAAaF,EAAMI,MAE9BJ,EAAMpB,WAAgD,IAAnCyB,OAAOC,KAAKzB,GAAYX,SAC3CS,EAAeqB,EAAMpB,UACrB2B,KAEAP,EAAMxB,OACN7B,QAAQC,IAAIoD,EAAMxB,MAClBA,EAAOwB,EAAMxB,OAIrB,IAAIgC,EAAe,SAACC,GAChB,IAAIC,EAmTZ,SAAgBnC,EAAGM,EAAY8B,GAE3B,GAAIA,EAAIC,KAAOD,EAAIE,IAAI,CACrB,IAAID,GAAOD,EAAIC,IAAI/B,EAAW+B,KAAK/B,EAAWiC,YAC1CD,GAAOF,EAAIE,IAAIhC,EAAWgC,KAAKhC,EAAWiC,YAC1CC,EAAQxC,EAAEyC,aAAaJ,EAAIC,GAI/B,OAHAE,EAAOE,GAAKF,EAAOE,EAAE,EAAE,GAAG,GAAI9C,KAAK+C,IAAI/C,KAAKgD,IAAIJ,EAAOE,GAAGpC,EAAWuC,WACrEL,EAAOM,GAAMN,EAAOM,EAAE,EAAE,GAAG,GAAIlD,KAAK+C,IAAI/C,KAAKgD,IAAIJ,EAAOM,GAAGxC,EAAWuC,WACtEL,EAAOM,IAAI,EACJN,EAET,OAAO,KA9TOO,CAAO/C,EAAGM,EAAY4B,GAC5Bc,EAA4B,EAArBb,EAAIc,MAAMC,QAAQ,GACzBC,EAA6C,GAAtChB,EAAIiB,UAAUxD,KAAKyD,GAAG,KAAKH,QAAQ,GAC9C,O,yVAAO,CAAP,GAAWhB,EAAX,CAAcC,IAAKA,EAAKa,KAAMA,EAAMM,OAAQH,KAG5CnB,EAAkB,WAClB5D,QAAQC,IAAI,mBACZ,IAAIkF,EAAMvD,EAAEwD,IAAIxD,EAAEyD,WAAa,GAC3BF,IACAlD,EAAYD,EAAasD,IAAIzB,GAAc0B,OAAOJ,IAEtDhD,IAAegD,EAAMnD,EAAaT,SAGlCiC,EAAe,WACf,IAAK,IAAIgC,EAAE,EAAGA,EAAE,GAAIA,IAChBnD,EAASmD,GAAKC,EAAMD,EAAGtD,EAAWiC,YAAajC,EAAWuC,YAKlE7C,EAAE8D,KAAO,WAyRb,IAAiBC,EAAYN,EAxRjBzD,EAAEyD,WAAa,KAAO,GAAKlD,GAC3ByB,IAEJ7B,EAAeD,EAqRN6D,EApRUzD,EAAWyD,WAoRTN,EApRqBzD,EAAEyD,WAA5CvD,EAqRI6D,EAAaN,EAAa,IAAO,EAAE7D,KAAKyD,IAAMzD,KAAKyD,GA/QvD7C,IACAR,EAAEgE,WAAW,IAAIxD,EAAc,KAC/BR,EAAEiE,SAAS,IACXjE,EAAEkE,KAAK,KACPlE,EAAEmE,OAAO,IAAI,IACbnE,EAAEoE,aAAa,GAEf,IAAIC,EAAI,uBAyRhB,SAAoBhE,GAChB,OAAOA,EAAUV,OA1Rc2E,CAAWjE,GAA9B,qBA6RhB,SAAoBA,GAChB,OAAOA,EAAUkE,QAAO,SAAArC,GAAC,OAAKA,EAAEsC,SAAO7E,OA9R0B8E,CAAWpE,GAAhE,2BAA6FL,EAAEyD,WAA/F,wBAAyHvD,EAASN,KAAKyD,GAAG,KAAKH,QAAQ,GAAvJ,SAiPhB,SAAkBlD,EAAGqE,GAEjBrE,EAAE0E,OACF1E,EAAEkE,KAAK,KACPlE,EAAEiE,SAAS,IACXjE,EAAE2E,YAAY,IACd3E,EAAEqE,KAAK,IAAIO,KAAQ,GAAI5E,EAAE6E,OAAO,IAChC7E,EAAE8E,MAIF9E,EAAE0E,OACE1E,EAAEkE,KAAK,IAAI,KACXlE,EAAEqE,KAAKA,EAAM,GAAI,IAErBrE,EAAE8E,MA/PEC,CAAS/E,EAAGqE,GAEZrE,EAAEgF,UAAUhF,EAAEiF,MAAM,EAAGjF,EAAE6E,OAAO,GAyMxC,SAAoB7E,EAAGS,GACnB,IAAIgD,EAAazD,EAAEyD,WACnBzD,EAAEkF,SACF,IAAI,IAAItB,EAAE,EAAEA,EAAE,GAAGA,IAAI,CAEjB,IAAIuB,EAAI,EAIR,GAHI1E,EAASd,OAASiE,IAAGuB,EAAI1E,EAASmD,IAEtC5D,EAAEmE,OAAO,IAAKvE,KAAKwF,IAAI,GAAGxB,EAAE,GAAG,GAAG,GAAgC,EAA3BhE,KAAKyF,KAAK5B,EAAW,GAAGG,IAC3DA,EAAE,EAAE,CACJ5D,EAAEkE,KAAK,IAAI,IAAI,IAAI,EAA6B,EAAzBlE,EAAEsF,MAAM7B,EAAW,GAAGG,IAC7C5D,EAAEmE,OAAO,IAAI,IACbnE,EAAEuF,WAAWvF,EAAEwF,OAEf,IAAI,IAAIC,EAAE,EAAGA,EAAE,IAAKA,IAAI,CACpB,IAAIC,EAAOC,EAAUR,EAAG1B,EAAYG,EAAG6B,EAAG,IAAI,GAAG7B,IACjD5D,EAAE4F,OAAOF,EAAK9F,KAAKiG,IAAI7F,EAAE8F,QAAQL,EAAEhC,EAAW,KAAKiC,EAAK9F,KAAKyF,IAAIrF,EAAE8F,QAAQL,EAAEhC,EAAW,MAE5FzD,EAAE+F,WAEF/F,EAAEgG,WAEFhG,EAAEuF,aACF,IAAI,IAAIE,EAAE,EAAEA,EAAE,IAAIA,IAAI,CAClB,IAAIC,EAAOC,EAAUR,EAAG1B,EAAYG,EAAG6B,EAAG,IAAI,EAAE7B,IAChD5D,EAAE4F,OAAOF,EAAK9F,KAAKiG,IAAI7F,EAAE8F,QAAQL,EAAEhC,EAAW,KAAKiC,EAAK9F,KAAKyF,IAAIrF,EAAE8F,QAAQL,EAAEhC,EAAW,MAE5FzD,EAAE+F,SAAS/F,EAAEiG,YAGbjG,EAAEkF,SACFlF,EAAEkG,QAAQ,EAAE,EAAEf,EAAEA,IAvOpBgB,CAAWnG,EAAGS,GAyFtB,SAAuBT,EAAGK,EAAWH,EAAUC,EAAcG,GAKzD,IAAI8F,EAJJpG,EAAEiE,SAAS,IACXjE,EAAEkE,KAAK,KACPlE,EAAEmE,OAAO,IAAI,IACbnE,EAAEoE,aAAa,GAEf/D,EAAUgG,SAAQ,SAAEnE,EAAGoE,GACnB,IAEIC,EAFAC,EAAY5B,KAAK6B,MAAOvE,EAAEwE,UAC1BC,EAAazE,EAAEC,IAAIiB,UAEnBwD,EAAQ1E,EAAE2E,OACd,GAAK3E,EAAEC,IAAP,CAIAoE,EAAaI,EAAazG,EAC1B,IAAI4G,GAAY3G,EAAewG,IAAezG,EAAWyG,IAAe,GACrD/G,KAAKgD,IAAIzC,EAAeD,GAAY,EAEvD,GAAI4G,EAAQ,CACR,GAAIV,IAAgBlE,EAAE,CAYlB,IAAI7C,EAAI,CAGJG,MAAOuH,EAAa7E,EAAEc,KAAM1C,EAAWiC,YAAajC,EAAWuC,WAC/DS,OAAQpB,EAAEoB,OACVN,KAAMd,EAAEc,KACRwB,MAAOtC,EAAEsC,MACTrC,IAAKD,EAAEC,KAEX/C,EAAaC,GAGjB+G,EAAclE,EAGlBlC,EAAE0E,OACF,IAAI1B,EAAOd,EAAEC,IAAIc,MAGjB,GAAID,EAAiB,EAAVhD,EAAEiF,MAAU,CACnBjF,EAAEkF,SACFlF,EAAEuF,aACF,IAAI,IAAIE,EAAE,EAAGA,EAAIzC,EAAK,GAAIyC,GAAG,EAAE,CAC3B,IAAIuB,EAAWL,EAAa3G,EAAEsF,MAAMtF,EAAEyD,WAAW,GAAIgC,EAAE,IAAI,GAC3DzF,EAAE4F,OAAOhG,KAAKiG,IAAImB,GAAUvB,EAAG7F,KAAKyF,IAAI2B,GAAUvB,GAGtDzF,EAAE+F,WAEN/F,EAAE8E,MAEF,IAAImC,EAAYrH,KAAKgD,IAAI2D,GAAsB,EAAR3G,KAAKyD,KAAU,KAAQkD,EAAa,EACvEU,IAEAjH,EAAE0E,OACE1E,EAAEkE,KAAK,EAAE,EAAE,EAAE,IACblE,EAAEgG,WACFhG,EAAEkH,KAAKhF,EAAEC,IAAIO,EAAE,EAAER,EAAEC,IAAIW,EAAE,EAAG9C,EAAEmH,UAAUP,GAAO,EAAE,IACjD5G,EAAEkE,KAAK,KACPlE,EAAEqE,KAAKuC,EAAO1E,EAAEC,IAAIO,EAAE,GAAIR,EAAEC,IAAIW,EAAE,GACtC9C,EAAE8E,OAGDgC,EAGD9G,EAAEkE,KAAK,KAFPlE,EAAEkE,KAAK,IAAK,EAAE,IAAItE,KAAKvB,IAAImI,IAAcS,EAAY,GAAK,IAM9D,IAAIvB,EAAO,GAAKa,EAAW,EAAE3G,KAAKwF,IAAIxF,KAAKC,KAAK,EAAG0G,EAAY,GAAG,GAAG,GAAuC,EAAlCvG,EAAEsF,MAAMgB,EAAKtG,EAAEyD,WAAYvB,EAAEG,KAElGH,EAAEsC,QACHxE,EAAEkE,KAAK,IAAI,EAAE,GAEbwB,EAAM,EAA6B,EAA1B9F,KAAKyF,IAAIrF,EAAEyD,WAAW,IAC/BzD,EAAE0E,OACE1E,EAAEmE,OAAO,IAAI,KACbnE,EAAEoH,SAASpH,EAAEqH,QACbrH,EAAEgF,UAAU9C,EAAEC,IAAIO,EAAER,EAAEC,IAAIW,GAC1B9C,EAAEsH,OAAOtH,EAAEyD,YAAY,GAAIvB,EAAEG,IAAI,MACjCrC,EAAEkF,SACFlF,EAAEkH,KAAK,EAAE,EAAE,GAAG,IAClBlH,EAAE8E,MACF9E,EAAEqE,KAAF,mBAAoBrE,EAAEyD,WAAa,GAAI,EAAE,IAAI,GAA7C,iBAAyDmD,GACrD1E,EAAEC,IAAIO,EAAE,GAAIR,EAAEC,IAAIW,EAAE,KAE5B9C,EAAEkG,QAAQhE,EAAEC,IAAIO,EAAGR,EAAEC,IAAIW,EAAG4C,EAAMA,QAvF9BtH,QAAQC,IAAI,mBApGhBkJ,CAAcvH,EAAGK,EAAWH,EAAUC,EAAcG,GAEpDN,EAAEkF,SAoEV,SAAuBlF,EAAGE,GACtBF,EAAE0E,OACE1E,EAAEmE,OAAO,IAAI,KACbnE,EAAEoE,aAAa,GACfpE,EAAEwH,KAAK,EAAE,EAAqB,IAAnB5H,KAAKiG,IAAI3F,GAAmC,IAAnBN,KAAKyF,IAAInF,IAC7CF,EAAEgG,WAEF,IADA,IACQpC,EAAE,EAAEA,EADE,GACUA,IACpB5D,EAAEkE,KAAK,IAAI,KAFD,GAEsBN,IAChC5D,EAAEuF,aACFvF,EAAE4F,OAAO,EAAE,GACX5F,EAAE4F,OAAqC,IAA9BhG,KAAKiG,IAAI3F,EAAS,KAAM0D,EAAE,IAAuC,IAA9BhE,KAAKyF,IAAInF,EAAS,KAAM0D,EAAE,KACtE5D,EAAE4F,OAAiC,IAA1BhG,KAAKiG,IAAI3F,EAAS,IAAK0D,GAAkC,IAA1BhE,KAAKyF,IAAInF,EAAS,IAAK0D,IAC/D5D,EAAE+F,SAAS/F,EAAEiG,OAErBjG,EAAE8E,MAlFE2C,CAAczH,EAAGE,GA4CzB,SAAoBF,EAAG2B,GACnB3B,EAAE0E,OACE1E,EAAEkE,KAAK,QACPlE,EAAEgG,WACFhG,EAAEkG,QAAQ,EAAE,EAAE,EAAE,GAChBlG,EAAEoH,SAASpH,EAAEqH,QACbrH,EAAEmE,OAAO,KACTnE,EAAEkF,SACFlF,EAAEoE,aAAa,GACfpE,EAAEkH,KAAK,EAAE,EAAE,GAAG,IAGdlH,EAAEsH,OAAOtH,EAAEyD,WAAW,KACtBzD,EAAEmE,OAAO,IAAI,IACbnE,EAAEkH,KAAK,EAAE,EAAE,GAAG,IAClBlH,EAAE8E,MAEF9E,EAAE0E,OACE1E,EAAEkE,KAAK,IAAI,KACXlE,EAAEqE,KAAK1C,EAAY,GAAI,IAC3B3B,EAAE8E,MA/DE4C,CAAW1H,EAAGM,EAAWqB,YAejC,SAAsB3B,GAClBA,EAAE0E,OACE1E,EAAEmE,OAAO,IAAI,KACbnE,EAAEoE,aAAa,IACfpE,EAAEkH,MAAMlH,EAAEiF,MAAM,GAAGjF,EAAE6E,OAAO,EAAG7E,EAAEiF,MAAOjF,EAAE6E,QAC1C7E,EAAEoE,aAAa,GACfpE,EAAEmE,OAAO,IAAI,IAEbnE,EAAEkH,MAAMlH,EAAEiF,MAAM,EAAE,IAAIjF,EAAE6E,OAAO,EAAE,GAAI7E,EAAEiF,MAAM,GAAIjF,EAAE6E,OAAO,IAE1D7E,EAAEmE,OAAO,IAAI,KACbnE,EAAEoE,aAAa,GACfpE,EAAEwH,MAAMxH,EAAEiF,MAAM,EAAE,GAAGjF,EAAEiF,MAAM,EAAE,GAAG,GAClCjF,EAAEwH,KAAKxH,EAAEiF,MAAM,EAAE,EAAEjF,EAAEiF,MAAM,EAAE,GAAG,GAEhCjF,EAAEwH,KAAK,GAAGxH,EAAE6E,OAAO,EAAE,GAAG7E,EAAE6E,OAAO,EAAE,IACnC7E,EAAEwH,KAAK,EAAExH,EAAE6E,OAAO,EAAE,EAAE7E,EAAE6E,OAAO,EAAE,IAEjC7E,EAAEgG,WACFhG,EAAEkE,KAAK,IAAI,KACXlE,EAAE2H,UAAU3H,EAAEqH,QACdrH,EAAEqE,KAAK,KAAKrE,EAAEiF,MAAM,EAAE,GAAG,GAAG,GAC5BjF,EAAEqE,KAAK,IAAIrE,EAAEiF,MAAM,EAAE,GAAG,GAAG,GAC3BjF,EAAEqE,KAAK,IAAI,GAAGrE,EAAE6E,OAAO,EAAE,GAAG,IAC5B7E,EAAEqE,KAAK,IAAI,EAAErE,EAAE6E,OAAO,EAAE,GAAG,IAC/B7E,EAAE8E,MAvCE8C,CAAa5H,GAKrB,SAAqBA,GACjB,IAAI6H,GAAM,IAAIjD,MAAOkD,aACrB9H,EAAEkE,KAAK,KACPlE,EAAEkH,MAAMlH,EAAEiF,MAAM,EAAG4C,EAAM,EAAG,GAAG,GAAG7H,EAAE6E,OAAO,EAAE,GAAG,GAAG,GACnD7E,EAAEmE,OAAO,KACTnE,EAAEkF,SACFlF,EAAEkH,MAAMlH,EAAEiF,MAAM,GAAK4C,EAAI,GAAK,EAAG,GAAG,GAAG7H,EAAE6E,OAAO,EAAE,GAAG,GAAG,GAVpDkD,CAAY/H,IAyLpB,SAAS6D,EAAMD,EAAGrB,EAAaM,GAC3B,MAA2D,GAApDjD,KAAK+C,IAAI/C,KAAKgD,IAAIgB,EAAIrB,EAAc,IAAKM,GAGpD,SAASkE,EAAa/D,EAAMT,EAAaM,GACvC,OAAOjD,KAAKoI,KAAsC,GAAjCpI,KAAK+C,IAAIK,EAAK,IAAM,EAAEH,GAAcN,GA0DvD,SAASoD,EAAUR,EAAG1B,EAAYG,EAAG6B,EAAGwC,GACpC,OAAO9C,EAAE,EAAIvF,KAAKyF,IAAI5B,GAAY,GAAK,GAAFG,GAAM6B,EAAE,IAAI,EAAE7F,KAAKyD,GAAG,IAAI4E,E,YCvWnEC,gBHL8B,CAE1BC,OAAQ,0CACRC,WAAY,6BACZC,YAAa,oCACbC,UAAW,aACXC,cAAe,yBACfC,kBAAmB,iBGDvB,IACaC,EADOP,aAAoBQ,MACDC,MAAM,kBCPlCC,G,QAAgB,GAChBC,EAAU,GAIVC,EAkCX,WACE,IAAIC,EAAYC,UAAUD,WAAaC,UAAUC,QAAUC,OAAOC,MAChE,GAAI,yBAAyBC,KAAKL,GAChC,MAAO,mHAGT,GAAI,mBAAmBK,KAAKL,KAAeG,OAAOG,SAChD,MAAO,sHAET,MAAO,6BA3CUC,GAErB,SAASC,EAAaC,GAClBpL,QAAQC,IAAI,OACZuK,GAAgB,EAChBC,EAAU,CACNvG,IAAKkH,EAASC,OAAOC,SACrBrH,IAAKmH,EAASC,OAAOE,UACrBjD,UAAW9B,KAAK6B,MAChBmD,KAAMhF,KAAKA,KAAK6B,OAChBjC,OAAO,GAIf,SAASqF,EAAmBC,GAIxB,OAFF1L,QAAQC,IAAI,QAAQyK,GAClBF,GAAgB,EACRkB,EAAcC,MAElB,KAAK,EACL3L,QAAQC,IAAI,qBACZ,MAEA,KAAK,EACLD,QAAQC,IAAI,yCACZ,MAEA,KAAK,EACLD,QAAQC,IAAI,wC,0CC3Bb,SAAS2L,EAAUvI,GAAQ,IAAD,EACLwI,mBAASxI,EAAMyI,MADV,mBACtBA,EADsB,KAChBC,EADgB,OAELF,mBAAS,IAFJ,mBAEtBpI,EAFsB,KAEhBuI,EAFgB,KAGvBC,EAAc,WAChBF,GAAQ,GACRzI,MAAM,QAAQG,GACD,KAATA,GACAJ,EAAM6I,SAASzI,IAMvB,OACE,oCAKE,kBAAC0I,EAAA,EAAD,CAAOL,KAAMA,EACLM,UAAU,EACVC,gBAAiB,oBACjBC,kBAAmB,uBACvB,kBAACH,EAAA,EAAMI,KAAP,CAAYC,SAAU,mBAClB,2BAAOC,QAAQ,QAAf,qBADJ,IACoD,6BAChD,2BAAO7J,GAAG,OAAOnC,KAAK,OAAOiM,YAAarJ,EAAMI,KAC5Cd,MAAOc,EAAMyI,SAAU,SAAApI,GAAC,OAAIkI,EAAQlI,EAAE6I,OAAOhK,WAGrD,kBAACwJ,EAAA,EAAMS,OAAP,CAAcJ,SAAU,qBACpB,kBAACK,EAAA,EAAD,CAAQC,QAAQ,OAAOC,KAAK,KAAKC,QAASf,GAA1C,WAGA,kBAACY,EAAA,EAAD,CAAQC,QAAQ,QAAQC,KAAK,KAAKC,QAASf,GAA3C,W,yjBChChB,IAAMgB,EAAa,oBACbC,EAAe,kBACfC,EAAe,yBAEfC,E,2MACFC,MAAQ,CACJC,GAAI,GACJC,aAAc,GACdtL,UAAW,I,EAiBfuL,QAAU,a,EAIVC,cAAgB,SAACF,GACbvN,QAAQC,IAAI,iBAGZ,EAAKyN,SAAS,CAEVzL,UAAWyB,OAAOiK,QAAQJ,GACzBpH,QAAO,SAAAlF,GACJ,OAAOA,EAAE,KAAOwJ,EAAQmD,OAC3BtI,KAAI,SAAArE,GAAC,YACGA,EAAE,GADL,CACS2M,IAAK3M,EAAE,W,EAK9B4M,UAAY,SAACN,GAET7J,OAAOiK,QAAQJ,GAActF,SAAQ,SAACnE,IAE5B,QAASA,EAAE,IACbuG,EAAYE,MAAMzG,EAAE,IAAIyG,MAAM,OAAOuD,IAAIhK,EAAE,IAGzC,WAAYA,EAAE,KAAOA,EAAE,IACzBuG,EAAYE,MAAMzG,EAAE,IAAIyG,MAAM,UAAUuD,IAAIC,EAAUjK,EAAE,KAGvDA,EAAE,GAAGwE,WAAcxE,EAAE,GAAGI,KAAQJ,EAAE,GAAGG,KAGtBuC,KAAK6B,MAAMvE,EAAE,GAAGwE,UAEhB,IACPxE,EAAE,GAAGsC,OACNiE,EAAYE,MAAMzG,EAAE,IAAIyG,MAAM,SAASuD,KAAI,GAI3ChK,EAAE,GAAGsC,OACLiE,EAAYE,MAAMzG,EAAE,IAAIyG,MAAM,SAASuD,KAAI,GAXnDzD,EAAYE,MAAMzG,EAAE,IAAIkK,a,mFA9Cf,IAAD,OAEhBhO,QAAQC,IAAI,YFlBhB2K,UAAUqD,YAAYC,cAAc/C,EAAcM,GEoB9CpB,EAAYtK,GAAG,SAAS,SAACoO,GAMrB,EAAKV,cAAcU,EAASC,Y,+BAuDhC,OAAQ,oCACH5D,GAAiB,kBAAC,EAAD,CAAcvI,UAAWoM,KAAKhB,MAAMpL,iB,GAzE5CqM,aA+EhBC,E,2MACFlB,MAAQ,CACJ/K,KAAM,CACF6B,YAAa,KACbM,UAAW,IACX+J,cAAe,IACf7I,WAAY,GACZzB,IAAKuG,EAAQvG,IACbD,IAAKwG,EAAQxG,IACbV,WAAY,UAEhBE,KAAM,U,EAiCVgL,UAAY,WACR,IAAI5M,EACA6M,EAASC,aAAaC,QAAQ3B,GAC9B4B,EAAaF,aAAaC,QAAQzB,GAClC1E,EAASkG,aAAaC,QAAQ1B,GAC9BwB,GAAWlI,KAAK6B,MAAQwG,EAAa,MACrC7O,QAAQC,IAAI,wBAA0ByO,GACtC7M,EAAO6M,EACPC,aAAaG,QAAQ3B,EAAc3G,KAAK6B,SAExCxG,EAAOwI,EAAY/D,KAAKmE,GAASmD,IACjCnF,EAASsF,EAAUlM,GACnB7B,QAAQC,IAAI,mBAAqB4B,GACjC8M,aAAaG,QAAQ7B,EAAWpL,GAChC8M,aAAaG,QAAQ3B,EAAc3G,KAAK6B,QAG5CoC,EAAQmD,IAAM/L,EAET4G,IACDA,EAASsF,EAAUlM,IACvB4I,EAAQhC,OAASA,EACjB4B,EAAYE,MAAM1I,GAAMiM,IAAIrD,GAC5B,EAAKsE,kBAAkBtG,GAAQ,I,EAGnCsG,kBAAoB,SAACtL,EAAMuL,GACvB1L,MAAM,eAAeG,GACrBkL,aAAaG,QAAQ5B,EAAczJ,GAE/BuL,GACA3E,EAAYE,MAAME,EAAQmD,KAAKrD,MAAM,UAAUuD,IAAIrK,GACvD,EAAKiK,SAAS,CAACpL,KAAK,KAAI,EAAK+K,MAAM/K,KAAhB,CAAsBiB,WAAYE,IAAOA,KAAMA,K,EAGtEwL,iBAAmB,SAACxL,GAChBH,MAAM,eAAeG,GACrBkL,aAAaG,QAAQ5B,EAAczJ,GAGnC4G,EAAYE,MAAME,EAAQmD,KAAKrD,MAAM,UAAUuD,IAAIrK,GACnD,EAAKiK,SAAS,CAACpL,KAAK,KAAI,EAAK+K,MAAM/K,KAAhB,CAAsBiB,WAAYE,IAAOA,KAAMA,K,EAGtEyL,gBAAkB,WAAO,IAChB5M,EAAQ,EAAK+K,MAAb/K,KACL6M,eAAeL,QAAQ,cAAetM,KAAK4M,UAAL,KAAmB9M,M,EAG7D+M,yBAA2B,SAACvL,GACxBuG,EAAYE,MAAME,EAAQmD,KAAKrD,MAAM,SAASuD,KAAI,I,mFA9ElDhD,OAAOwE,iBAAiB,eAAgBjB,KAAKgB,0BAC7ChB,KAAKI,c,6CAwBL3D,OAAOyE,oBAAoB,eAAgBlB,KAAKgB,4B,+BAyD1C,IACC/M,EAAQ+L,KAAKhB,MAAb/K,KACFL,EAAaoM,KAAKhL,MAAlBpB,UAEL,OADAqB,MAAM+K,KAAKhB,MAAM5J,MAEb,oCACA,kBAAC,EAAD,CAAWqI,MAAM,EAAMrI,KAAMnB,EAAKiB,WACtB2I,SAAUmC,KAAKY,mBAC3B,kBAAC,IAAD,CAAWtN,OAAQA,EAAQM,UAAWA,EAC9BwB,KAAM4K,KAAKhB,MAAM5J,KAAMvB,WAAYI,EAAMT,KAAM4I,EAAQmD,W,GA3GhDU,aAoHrBP,EAAY,SAACnL,GACf,MAAO,IAAOA,EAAG4M,MAAM,IAAIlK,KAAI,SAAAmK,GAAE,OAAEA,EAAGC,WAAW,MAAIC,QAAO,SAACC,EAAEC,GAAH,OAAQD,EAAEC,IAAG,GAAK,KAGnEzC,ICrMA0C,G,wLANX,OACE,kBAAC,EAAD,U,GAJYC,IAAMzB,YCAxB0B,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,U","file":"static/js/main.07d1cb40.chunk.js","sourcesContent":["import io from 'socket.io-client';\nimport {serverIP} from './config';\n\nconst socket = io(serverIP);\nlet isSocketConnect = false;\nsocket.on('connect', () => {\n    isSocketConnect = true;\n    console.log('socket connect to server');\n})\n\nexport let emitOSC = (address, value)=> {\n    socket.emit('osc', {\n        address: address,\n        args: [{\n            value: value\n        }]\n    });\n}\n\nexport let receiveOSC = (func) => {\n    socket.on('osc', func);\n}\n\nexport {isSocketConnect};","export const firebaseConfig = {\n    //put firebase config here\n    apiKey: \"AIzaSyBlfFaGBx7B_nBnlR29yhJAr6kPjqAdLfo\",\n    authDomain: \"test-84ae7.firebaseapp.com\",\n    databaseURL: \"https://test-84ae7.firebaseio.com\",\n    projectId: \"test-84ae7\",\n    storageBucket: \"test-84ae7.appspot.com\",\n    messagingSenderId: \"762464277938\"\n};\nexport const serverIP = 'localhost:8000'; // change IP here","import Tone from 'tone';\nlet octave = 'BCDEFGA'; //start from index 1 so put C at second \nlet octaveStart = 3;\nlet octaveMax = 6;\nlet synth;\n\nexport let initSound = () => {\n    synth = new Tone.Synth({\n        oscillator : {type:'sine'} ,\n        envelope : {\n            attack: 0.1 ,\n            decay: 0.1 ,\n            sustain: 0.2 ,\n            release: 0.5\n        }}).toMaster();\n}\n\nexport let triggerSound = (d) => {\n    synth.triggerAttackRelease(getNote(d.layer), '16n');\n}\n\nlet getNote = (number) => {\n    let len = octave.length;\n    return octave[number%len]+\n        Math.min(octaveMax, Math.floor(octaveStart+number/len));\n}","import {receiveOSC, emitOSC, isSocketConnect} from './socketUsage';\nimport {initSound, triggerSound} from './sound';\n//import {earthLocRef} from './firebase';\n\nexport default function sketch (p) {\n    let radioDeg = 0;\n    let lastRadioDeg = 0;\n    let allDataPoint = [];\n    let dataPoint = [];\n    let configData = {};\n    let enableUpdate = true;\n    let lightCounter = 0;\n    let rDistArr = [];\n    let myId;\n    let testBtn;\n\n    receiveOSC((data)=>{\n        if (data.address==\"/gps/trigger\"){\n            let scanId = JSON.parse(data.args[0].value).id\n            // console.log(scanId)\n            if (scanId == myId){\n                lightCounter = 0;\n            }\n        }\n    });\n\n    p.setup = () => {\n        p.createCanvas(p.windowWidth, p.windowHeight);\n        p.frameRate(30);\n        console.log('issocketConnect:' + isSocketConnect);\n        initSound();\n        // for test\n        // testBtn = p.createButton('yo');\n        // testBtn.position(19, 19);\n        // testBtn.mousePressed(()=>{\n        //     triggerSound();\n        // })\n    };\n\n    p.windowResized = () =>  {\n        p.resizeCanvas(p.windowWidth, p.windowHeight);\n    }\n\n    p.myCustomRedrawAccordingToNewPropsHandler = (props) => {\n        if (props.configData) {\n            alert(props.configData.centerName);\n            configData = props.configData;\n            calcRdistArr();\n        }\n        if (props.name) {\n            alert('sketch:'+props.name);\n            configData.centerName = props.name;\n        }\n        if (props.dataPoint && Object.keys(configData).length !== 0){\n            allDataPoint = props.dataPoint;\n            updateDataPoint();\n        }\n        if (props.myId) {\n            console.log(props.myId);\n            myId = props.myId;\n        }\n    };\n\n    let dataPointMap = (e) => {\n        let pos = getPos(p, configData, e);\n        let dist = pos.mag().toFixed(5)*1.0;\n        let deg = (pos.heading()/Math.PI*180).toFixed(5)*1.0;\n        return {...e, pos: pos, dist: dist, degree: deg}\n    }\n\n    let updateDataPoint = () => {\n        console.log('updateDataPoint');\n        let num = p.int(p.frameCount / 4);\n        if (num) {\n            dataPoint = allDataPoint.map(dataPointMap).slice(-num);\n        }\n        enableUpdate = num > allDataPoint.length ? false : true;\n    }\n\n    let calcRdistArr = () => {\n        for (let i=0; i<50; i++) {\n            rDistArr[i] = calcR(i, configData.globalScale, configData.globalPow);\n        }\n    }\n\n\n    p.draw = function () {\n        if (p.frameCount % 25 === 0 && enableUpdate){\n            updateDataPoint();\n        }\n        lastRadioDeg = radioDeg;\n        radioDeg = calcDeg(configData.radioSpeed, p.frameCount);\n\n        //emit radio\n        // if (p.frameCount % 30 === 0)\n        //     emitOSC('/gps/radio', (radioDeg/Math.PI*180).toFixed(5)*1.0)\n\n        lightCounter++;\n        p.background(255/lightCounter, 100);\n        p.textSize(12)\n        p.fill(255)\n        p.stroke(255,10)\n        p.strokeWeight(1)\n        \n        let text = `Total Nodes: ${calcPerson(dataPoint)}\\nActive: ${calcActive(dataPoint)}\\nExecute Time: ${p.frameCount}\\nScanning: ${(radioDeg/Math.PI*180).toFixed(2)}°`\n        drawText(p, text);\n        //將繪製點移動到畫布中央\n        p.translate(p.width/2, p.height/2);\n        drawCircle(p, rDistArr);\n        drawDataPoint(p, dataPoint, radioDeg, lastRadioDeg, configData);\n        \n        p.noFill()\n        drawSwipeLine(p, radioDeg);\n        drawCenter(p, configData.centerName);\n        drawMapFrame(p);\n        drawSecRect(p);\n    };\n};\n\nfunction drawSecRect(p) {\n    let sec = new Date().getSeconds();\n    p.fill(255);\n    p.rect(-p.width/2+(sec % 5)*30+20,p.height/2-75,25,6);\n    p.stroke(255);\n    p.noFill();\n    p.rect(-p.width/2+( (sec+1) % 5)*30+20,p.height/2-75,25,6);\n}\n\nfunction drawMapFrame(p) {\n    p.push();\n        p.stroke(255,255);\n        p.strokeWeight(10);\n        p.rect(-p.width/2,-p.height/2, p.width, p.height);\n        p.strokeWeight(1);\n        p.stroke(255,30);\n        \n        p.rect(-p.width/2+10,-p.height/2+10, p.width-20, p.height-20);\n    \n        p.stroke(255,255);\n        p.strokeWeight(2);\n        p.line(-p.width/2,0,-p.width/2+20,0);\n        p.line(p.width/2,0,p.width/2-20,0);\n    \n        p.line(0,-p.height/2,0,-p.height/2+20);\n        p.line(0,p.height/2,0,p.height/2-20);\n    \n        p.noStroke();\n        p.fill(255,200);\n        p.textAlign(p.CENTER);\n        p.text('W',-p.width/2+20+15,5);\n        p.text('E',p.width/2-20-15,5);\n        p.text('N',0,-p.height/2+20+20);\n        p.text('S',0,p.height/2-20-10);\n    p.pop();\n}\n\nfunction drawCenter(p, centerName) {\n    p.push();\n        p.fill(\"#f24\");\n        p.noStroke();\n        p.ellipse(0,0,8,8);\n        p.rectMode(p.CENTER);\n        p.stroke(255);\n        p.noFill();\n        p.strokeWeight(2);\n        p.rect(0,0,20,20);\n    \n    \n        p.rotate(p.frameCount/100);\n        p.stroke(255,20);\n        p.rect(0,0,20,20);\n    p.pop();\n\n    p.push();\n        p.fill(255,200);\n        p.text(centerName, 20, 12);\n    p.pop();\n}\n\nfunction drawSwipeLine(p, radioDeg) {\n    p.push()\n        p.stroke(255,200)\n        p.strokeWeight(2)\n        p.line(0,0,Math.cos(radioDeg)*1000, Math.sin(radioDeg)*1000)\n        p.noStroke()\n        let degSpan = 20\n        for(var i=0;i < degSpan;i++){\n            p.fill(255,50/ degSpan*(degSpan-i) )\n            p.beginShape()\n            p.vertex(0,0)\n            p.vertex(Math.cos(radioDeg-0.02*(i-1))*1000,Math.sin(radioDeg-0.02*(i-1))*1000)\n            p.vertex(Math.cos(radioDeg-0.02*i)*1000,Math.sin(radioDeg-0.02*i)*1000)\n            p.endShape(p.CLOSE)\n        }\n    p.pop()\n}\n\nfunction drawDataPoint(p, dataPoint, radioDeg, lastRadioDeg, configData) {\n    p.textSize(12)\n    p.fill(255)\n    p.stroke(255,10)\n    p.strokeWeight(1)\n    let lastTrigger;\n    dataPoint.forEach(( e, eid)=>{\n        let timeDelta = Date.now()- e.timeStamp;\n        let dataDegree = e.pos.heading();\n        let angleDelta = -1000\n        let nowId = e.showId;\n        if (!e.pos) {\n            console.log('no position?');\n            return;\n        }\n        angleDelta = dataDegree - radioDeg;\n        let scanned = ((lastRadioDeg - dataDegree) * (radioDeg - dataDegree) <= 0)\n                        && Math.abs(lastRadioDeg - radioDeg) < 1;\n        \n        if (scanned){\n            if (lastTrigger !== e){\n                //console.log(e);\n                // let d = JSON.stringify({\n                //     degree: e.degree,\n                //     dist: e.dist,\n                //     id: e.key,\n                //     data: e.data,\n                //     leave: e.leave,\n                //     timeStamp: e.timeStamp,\n                //     time_to_now_second: timeDelta,\n                // })\n               \n                let d = {  \n                    //layer: Math.ceil(Math.pow(e.dist/0.5, 1/configData.globalPow)*10/configData.globalScale),\n                    //layer: Math.ceil(Math.pow(e.dist/0.5, 1/configData.globalPow)*10/configData.globalScale),\n                    layer: calcReverseR(e.dist, configData.globalScale, configData.globalPow),\n                    degree: e.degree,\n                    dist: e.dist,\n                    leave: e.leave,\n                    pos: e.pos,\n                }\n                triggerSound(d);\n                //emitOSC('/gps/trigger', d);\n            }\n            lastTrigger = e;\n        }\n\n        p.push()\n        let dist = e.pos.mag()\n\n        //draw line\n        if (dist < p.width * 2){\n            p.noFill()\n            p.beginShape()\n            for(var o=0; o < dist-10; o+=2){\n                let useAngle = dataDegree + p.noise(p.frameCount/10+ o/10)/60\n                p.vertex(Math.cos(useAngle)*o, Math.sin(useAngle)*o)\n                // line(o,o,a.pos.x*0.95,a.pos.y*0.95)\n            }\n            p.endShape()\n        }\n        p.pop()\n                \n        let scanAfter = Math.abs(angleDelta % (Math.PI*2) ) < 0.08 && angleDelta < 0\n        if (scanAfter){\n            \n            p.push()\n                p.fill(0,0,0,70)\n                p.noStroke()\n                p.rect(e.pos.x+6,e.pos.y-5, p.textWidth(nowId)+8,12)\n                p.fill(255)\n                p.text(nowId, e.pos.x+10, e.pos.y+5)\n            p.pop()\n        }\n           \n        if (!scanned){\n            p.fill(255, 5+150/Math.log(timeDelta) + (scanAfter ? 50 : 0))  \n        } else{\n            p.fill(255)\n        }\n        \n        //繪製正在線上的點\n        let useR = 5 + (angleDelta<0?Math.max(Math.min(-1/(angleDelta),6),0):0) + p.noise(eid, p.frameCount, e.lon)*2\n\n        if (!e.leave){\n            p.fill(255,0,0)\n            //p.text(this.uid, 0, 30)\n            useR= 5+ Math.sin(p.frameCount/10)*2\n            p.push()\n                p.stroke(255,200)\n                p.rectMode(p.CENTER)\n                p.translate(e.pos.x,e.pos.y)\n                p.rotate(p.frameCount/(10+ e.lon/100))\n                p.noFill()\n                p.rect(0,0,12,12)\n            p.pop()\n            p.text(`//ACTIVE ${(p.frameCount % 10 <5?\".\":\"\")}\\nID: ${nowId}`, \n                e.pos.x+10, e.pos.y+20)\n        }\n        p.ellipse(e.pos.x, e.pos.y, useR, useR)\n      })\n}\n\nfunction calcR(i, globalScale, globalPow) {\n    return Math.pow(Math.abs(i * globalScale / 10), globalPow)*0.5;\n}\n\nfunction calcReverseR(dist, globalScale, globalPow) {\n  return Math.ceil(Math.pow(dist/0.25, 1/globalPow)*10/globalScale);\n}\n\nfunction drawCircle(p, rDistArr) {\n    let frameCount = p.frameCount;\n    p.noFill();\n    for(let i=0;i<50;i++){\n        //let r = Math.pow(Math.abs(i * globalScale / 10), globalPow) * 0.5\n        let r = 0;\n        if (rDistArr.length > i) r = rDistArr[i];\n        //else r = calcR(i, globalScale, globalPow);\n        p.stroke(255, Math.max(60-i/10*60,4) + Math.sin(-frameCount/10+i)*4)\n        if (i<9){\n            p.fill(255,255,255,1 + p.noise(frameCount/10,i)*1)\n            p.stroke(255,20)\n            p.beginShape(p.LINES)\n    \n            for(let o=0; o<360; o++){\n                let useR = calcWaveR(r, frameCount, i, o, 50/(10-i));\n                p.vertex(useR*Math.cos(p.radians(o+frameCount/40)),useR*Math.sin(p.radians(o+frameCount/40)) )\n            }\n            p.endShape()\n          \n            p.noStroke()\n            //用 close 填內容色\n            p.beginShape()\n            for(let o=0;o<360;o++){\n                let useR = calcWaveR(r, frameCount, i, o, 30/(8-i));\n                p.vertex(useR*Math.cos(p.radians(o+frameCount/40)),useR*Math.sin(p.radians(o+frameCount/40)) )\n            }\n            p.endShape(p.CLOSE)\n\n        } else{\n            p.noFill()\n            p.ellipse(0,0,r,r)\n\n        }\n    }  \n}\n\nfunction drawText(p, text) {\n    //Draw Date Text \n    p.push();\n    p.fill(255);\n    p.textSize(14);\n    p.textLeading(24);\n    p.text(new Date(), 20, p.height-35);\n    p.pop();\n\n    //Show Number of Person\n    //TODO: Calculate Person\n    p.push();\n        p.fill(255,130);\n        p.text(text, 20, 35);\n        //p.text(\"Total Nodes: \"+calcPerson() + \"\\nActive: \" + allActiveCount + \"\\nExecute Time: \" + frameCount+\"\\nScanning: \"+parseFloat( radioDeg/PI*180).toFixed(2)+\"°\", 20, 35)\n    p.pop();\n}\n\nfunction calcWaveR(r, frameCount, i, o, mult) {\n    return r/2 + Math.sin(frameCount/(10+i*10)+o/360*2*Math.PI*10)*mult;\n}\n\nfunction calcDeg(radioSpeed, frameCount) {\n    return (radioSpeed * frameCount / 60) % (2*Math.PI) - Math.PI;\n}\n\nfunction getPos(p, configData, obj){\n\n    if (obj.lon && obj.lat){\n      let lon = (obj.lon-configData.lon)*configData.globalScale\n      let lat = (obj.lat-configData.lat)*configData.globalScale\n      let result= p.createVector(lon,lat)\n      result.x = (result.x>0?1:-1)* Math.pow(Math.abs(result.x),configData.globalPow)\n      result.y =  (result.y>0?1:-1)* Math.pow(Math.abs(result.y),configData.globalPow)\n      result.y*=-1\n      return result\n    } \n    return null\n}\n\nfunction calcPerson(dataPoint) {\n    return dataPoint.length;\n}\n\nfunction calcActive(dataPoint) {\n    return dataPoint.filter(e => !e.leave).length;\n}","import * as firebase from 'firebase';\nimport {firebaseConfig} from './config';\n//copy firebaseConfig from firebase website\n\n// Initialize Firebase\nfirebase.initializeApp(firebaseConfig);\nconst databaseRef = firebase.database().ref();\nexport const earthLocRef = databaseRef.child('earthlocations');","export let gpsPermission = false;\nexport let gpsData = {};\nexport let setupGPS = () => {\n    navigator.geolocation.watchPosition(showPosition, watchPositionError);\n}\nexport let gpsHelp = getSettingStr();\n\nfunction showPosition(position) {\n    console.log('yo!');\n    gpsPermission = true;\n    gpsData = {\n        lat: position.coords.latitude,\n        lon: position.coords.longitude,\n        timeStamp: Date.now(),\n        date: Date(Date.now()),\n        leave: false\n    }\n}\n    \nfunction watchPositionError(positionError)  {\n   \n  console.log('fail!'+gpsHelp);\n    gpsPermission = false;\n    switch (positionError.code) {\n        // PERMISSION_DENIED\n        case 1:\n        console.log('Permission denied')\n        break\n        // POSITION_UNAVAILABLE\n        case 2:\n        console.log('Permission allowed, location disabled')\n        break\n        // TIMEOUT\n        case 3:\n        console.log('Permission allowed, timeout reached')\n        break\n        }\n}\n\nfunction getSettingStr() {\n  var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n    if (/android|windows phone/i.test(userAgent)) {\n      return \"1. Open the Chrome app.\\n\\n2. Find and tap Settings.\\n\\n3. Tap Site settings > Location.\\n\\n4. Turn Location on.\";\n    }\n    // iOS detection from: http://stackoverflow.com/a/9039885/177710\n    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {\n      return \"1. Open the settings app.\\n\\n2. Find and tap Safari/Chrome.\\n\\n3. Tap Location.\\n\\n4. Select \\\"While Using the App\\\".\";\n    }\n    return \"Enable Location Permission\";\n}","import React, {useState} from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './NameModal.css';\n\nexport function NameModal(props) {\n    const [show, setShow] = useState(props.show);\n    const [name, setName] = useState(\"\");\n    const handleClose = () => {\n        setShow(false);\n        alert('name:'+name);\n        if (name !== \"\")\n            props.onChange(name);\n    }\n    const handleShow = () => {\n        setShow(true);\n    }\n  \n    return (\n      <>\n        {/* <Button variant=\"primary\" onClick={handleShow}>\n          Launch demo modal\n        </Button> */}\n  \n        <Modal show={show} \n                centered={true}\n                dialogClassName={'name-modal-dialog'}\n                backdropClassName={'name-modal-backdrop'}>\n            <Modal.Body bsPrefix={'name-modal-body'}>\n                <label htmlFor=\"name\">Name your session</label> <br/>\n                <input id=\"name\" type=\"text\" placeholder={props.name} \n                    value={name} onChange={e => setName(e.target.value)}></input>\n                \n            </Modal.Body>\n            <Modal.Footer bsPrefix={'name-modal-footer'}>\n                <Button variant=\"dark\" size=\"sm\" onClick={handleClose}>\n                    Default\n                </Button>\n                <Button variant=\"light\" size=\"sm\" onClick={handleClose}>\n                    Save\n                </Button>\n            </Modal.Footer>\n        </Modal>\n      </>\n    );\n}\n","import React, {Component} from 'react';\nimport P5Wrapper from 'react-p5-wrapper';\nimport sketch from './sketch';\nimport {earthLocRef} from './firebase';\nimport * as dat from 'dat.gui';\nimport {gpsPermission, gpsData, setupGPS} from './gps';\nimport {NameModal} from './NameModal';\n\nconst SESSION_ID = 'generative_geo_id';\nconst SESSION_NAME = 'generative_name';\nconst SESSION_TIME = 'generative_geo_id_time';\n\nclass LocData extends Component {\n    state = {\n        gp: {},\n        allLocations: [],\n        dataPoint: []\n    }\n\n    componentDidMount() {\n        //this.initGPS();\n        console.log('setupGPS');\n        setupGPS();\n        earthLocRef.on('value', (snapshot) => {\n            //console.log(snapshot.val());\n            // this.setState({\n            //     allLocations: snapshot.val()\n            // });\n            //getAll();\n            this.updateDataSet(snapshot.val());\n        });\n    }\n\n    initGPS = () => {\n        \n    }\n\n    updateDataSet = (allLocations) => {\n        console.log('updateDataset');\n        \n        //this.checkData(allLocations);\n        this.setState({\n            // dataPoint: Object.entries(this.state.allLocations).map(d => \n            dataPoint: Object.entries(allLocations)\n            .filter(d=> {\n                return d[0] !== gpsData.key})\n            .map(d => \n                ({...d[1], key: d[0]}))\n        })\n        \n    }\n\n    checkData = (allLocations) => {\n        //should be removed....\n        Object.entries(allLocations).forEach((e)=>{\n            //如果沒有 key 補上\n            if (!('key' in e[1])) {\n                earthLocRef.child(e[0]).child('key').set(e[0]);\n            }\n            //如果沒有 showId 補上\n            if (!('showId' in e[1]) && e[0] ){\n                earthLocRef.child(e[0]).child(\"showId\").set(getShowId(e[0]))\n            }\n            //如果沒有時間戳或位置資料，移除該資料\n            if (!e[1].timeStamp || !e[1].lat || !e[1].lon){\n                earthLocRef.child(e[0]).remove()\n            } else { //check offline\n                let timeDelta = Date.now()-e[1].timeStamp\n                //如果已離線>6秒，設定為離線\n                if (timeDelta > 6000){\n                    if (!e[1].leave){\n                        earthLocRef.child(e[0]).child('leave').set(true)\n                    }\n                } else{\n                    //如果沒有，設定為活躍\n                    if (e[1].leave){\n                        earthLocRef.child(e[0]).child('leave').set(false)    \n                    }\n                }\n            }\n        })\n    }\n\n    render() {\n        return (<>\n            {gpsPermission && <ControlPanel dataPoint={this.state.dataPoint}/>}\n            </>\n        );\n    }\n}\n\nclass ControlPanel extends Component {\n    state = {\n        data: {\n            globalScale: 250000,\n            globalPow: 0.58,\n            maxLineLength: 100,\n            radioSpeed: 0.8,\n            lat: gpsData.lat,\n            lon: gpsData.lon,\n            centerName: 'center'\n        }, \n        name: 'center'\n        //GUI: new dat.GUI()\n    }\n\n    componentDidMount() {\n        window.addEventListener(\"beforeunload\", this.handleWindowBeforeUnload);\n        this.addGPSKey();\n        //let dataStore = sessionStorage.getItem('controlData');\n        //console.log(dataStore);\n        //let {data, GUI} = this.state;\n        //if (dataStore) {\n        // data = JSON.parse(dataStore);\n        //     this.setState({\n        //         data: data\n        //     })\n        //} \n        // const btn = {'add config': this.saveControlData};\n        // GUI.add(data,\"globalScale\",1000,800000)\n        // GUI.add(data,\"globalPow\",0,0.99)\n        // GUI.add(data,\"maxLineLength\")\n        // GUI.add(data,'radioSpeed',0,3,0.01)\n        // GUI.add(data,'centerName')\n        // GUI.add(data,'lat',-90,90,0.01)\n        // GUI.add(data,'lon',-180,180,0.01)\n        // GUI.add(btn, 'add config');\n\n        // GUI.close()\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"beforeunload\", this.handleWindowBeforeUnload);\n    }\n\n    addGPSKey = () => {\n        let myId;\n        let lastId = localStorage.getItem(SESSION_ID)\n        let lastIdTime = localStorage.getItem(SESSION_TIME)\n        let showId = localStorage.getItem(SESSION_NAME)\n        if (lastId && (Date.now() - lastIdTime < 60*60*1000)){\n            console.log(\"Old Id Detected! use \" + lastId)\n            myId = lastId\n            localStorage.setItem(SESSION_TIME, Date.now())\n        } else{\n            myId = earthLocRef.push(gpsData).key;\n            showId = getShowId(myId);\n            console.log(\"Generate new id \" + myId)\n            localStorage.setItem(SESSION_ID,myId)\n            localStorage.setItem(SESSION_TIME, Date.now())\n        }\n        \n        gpsData.key = myId;\n\n        if (!showId)\n            showId = getShowId(myId);\n        gpsData.showId = showId;\n        earthLocRef.child(myId).set(gpsData);\n        this.changeCenterName2(showId, false);\n    }\n\n    changeCenterName2 = (name, updateFirebase) => {\n        alert('change name:'+name);\n        localStorage.setItem(SESSION_NAME, name);\n        //console.log(updateFirebase, name);\n        if (updateFirebase) \n            earthLocRef.child(gpsData.key).child('showId').set(name);\n        this.setState({data:{...this.state.data, centerName: name}, name: name});\n    }\n\n    changeCenterName = (name) => {\n        alert('change name:'+name);\n        localStorage.setItem(SESSION_NAME, name);\n        //console.log(updateFirebase, name);\n        //if (updateFirebase) \n        earthLocRef.child(gpsData.key).child('showId').set(name);\n        this.setState({data:{...this.state.data, centerName: name}, name: name});\n    }\n    \n    saveControlData = () => {\n        let {data} = this.state;\n        sessionStorage.setItem('controlData', JSON.stringify({...data}));\n    }\n\n    handleWindowBeforeUnload = (e) => {\n        earthLocRef.child(gpsData.key).child('leave').set(true);\n        return;\n    }\n\n    render() {\n        const {data} = this.state;\n        let {dataPoint} = this.props;\n        alert(this.state.name);\n        return (\n            <>\n            <NameModal show={true} name={data.centerName} \n                        onChange={this.changeCenterName}/>\n            <P5Wrapper sketch={sketch} dataPoint={dataPoint}\n                    name={this.state.name} configData={data} myId={gpsData.key}/>\n            </>\n        )\n\n\n    }\n\n}\n\nconst getShowId = (id) => {\n    return \"A\" + (id.split(\"\").map(ch=>ch.charCodeAt(0)).reduce((a,b)=>(a*b),1) % 1000)\n  }\n\nexport default LocData;","import React from 'react';\nimport LocData from './ControlPanel';\nimport './App.css';\n\n\nclass App extends React.Component {\n  \n  render() {\n    return (\n      <LocData/>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}